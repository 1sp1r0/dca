(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);throw new Error("Cannot find module '"+o+"'");}var f=n[o]={exports:{}};t[o][0].call(f.exports,function(e){var n=t[o][1][e];return s(n?n:e)},f,f.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){var Modal=require("./modules/modal");var Ads=require("./modules/ads");
var payAdapter=require("./modules/list/pay-adapter");var mergeAdapter=require("./modules/list/merge-adapter");var modifyAdapter=require("./modules/list/modify-adapter");var cancelAdapter=require("./modules/list/cancel-adapter");var removeAdapter=require("./modules/list/remove-adapter");var returnAdapter=require("./modules/list/return-adapter");var returnCancelAdapter=require("./modules/list/return-cancel-adapter");var doCancelAdapter=require("./modules/list/do-cancel-adapter");var doMergeAdapter=
require("./modules/list/do-merge-adapter");var rebuyAdapter=require("./modules/list/rebuy-adapter");var trackAdapter=require("./modules/list/track-adapter");var receiptAdapter=require("./modules/list/receipt-adapter");var template=require("./modules/list/template");var Config={getOrderListTab:"//order.vip.com/order/getOrderListTab",vsccardVerifiyUrl:"//order.vip.com/vsccard/sendcode",vscVerifiyUrl:"//order.vip.com/vsc/sendcode",vscPayCheck:"//order.vip.com/vsc/payCheck",vsccardPayCheck:"//order.vip.com/vsccard/payCheck",
wallet:"/order/wallet",cancelOrder:"//order.vip.com/vsc/cancelOrder",vsccardCancelOrder:"//order.vip.com/vsccard/cancelOrder"};var Order={init:function(){var oldModalShow=Modal.prototype.show,oldModalHide=Modal.prototype.hide;var isIE6="undefined"==typeof document.body.style.maxHeight;Modal.prototype.show=function(){oldModalShow.apply(this);if(isIE6){$(".u-ie6-select-mask").length==0&&$("#J_order_status").before('<iframe frameborder="0" scrolling="no" class="u-ie6-select-mask"></iframe>');$(".u-ie6-select-mask").show()}};
Modal.prototype.hide=function(){oldModalHide.apply(this);if(isIE6)$(".u-ie6-select-mask").hide()};$("#J_modal_timeout").hide();$(document).ajaxComplete(function(event,XMLHttpRequest,ajaxOptions){try{var obj=$.parseJSON(XMLHttpRequest.responseText.replace(/^jQuery\d+_{1}\d+\({1}/,"").replace(/\){1}$/,""));if(obj.code&&obj.code===120)location.href="https://passport.vip.com/login?src="+location.href}catch(exception){VIPSHOP.log("somethinf wrong~")}});this.modalAlert=new Modal({element:"#J_modal_general"});
this.modalConfirm=new Modal({element:"#J_modal_confirm"});this.modalCountdown=new Modal({element:"#J_modal_countdown"});this.modalWalletWarning=new Modal({element:"#J_modal_wallet_warning"});this.modalOnceMore=new Modal({element:"#J_modal_pay_once_more"});this.modalOnceMoreMobileOnly=new Modal({element:"#J_modal_pay_once_more_mobile_only"});this.modalNoStock=new Modal({element:"#J_modal_no_stock"});this.modalPartInStock=new Modal({element:"#J_modal_part_in_stock"});this.modalCancel=new Modal({element:"#J_modal_cancel"});
this.modalCancelSuccess=new Modal({element:"#J_modal_cancel_success"});this.modalMerge=new Modal({element:"#J_modal_merge"});this.modalMergeEmpty=new Modal({element:"#J_modal_merge_empty"});this.modalMergeConfirm=new Modal({element:"#J_modal_merge_confirm"});this.modalMergeSuccessWithMessage=new Modal({element:"#J_modal_mergeSuccessWithMessage"});this.modalMergeSuccess=new Modal({element:"#J_modal_mergeSuccess"});this.modalMergePaybackFail=new Modal({element:"#J_modal_merge_paybackFail"});this.modalReturnComfire=
new Modal({element:"#J_modal_return_confirm"});this.modalVscComfire=new Modal({element:"#J_modal_vsc_confirm"});this.modalVerifyAlert=new Modal({element:"#J_modal_verify"});this.$orderList=$("#J_order_list");this.mergeRowTpl=$("#J_merge_row").html();this.payStockTpl=$("#J_pay_stock_row").html();this.mergeAlipayTpl=$("#J_merge_alipay_tpl").html();this.mergeAlipayFirstTpl=$("#J_merge_alipay_first_tpl").html();this.onceMoreStates="has-deal has-no-deal has-no-delivery";var _payTypeStates=["pay-no-alipay",
"pay-no-pos","pay-all-available"];this.payTypeStates={all:_payTypeStates.join(" ")};this.payTypeStates[mergeAdapter.DELIVERY_NO_ALIPAY]=_payTypeStates[0];this.payTypeStates[mergeAdapter.DELIVERY_NO_POS]=_payTypeStates[1];this.payTypeStates[mergeAdapter.DELIVERY_ALL_AVAILABLE]=_payTypeStates[2];var getSearchParam=function(key){var pairs=location.search.replace("?","").replace("script","_").replace("function","_").split("&");var pair;var pairSplit;for(var i=0,l=pairs.length;i<l;i++){pair=pairs[i];pairSplit=
pair.split("=");if(pairSplit[0]===key)return pairSplit[1]}};this.$orderList.find("option").prop("selected",false).eq(parseInt(getSearchParam("status")||"0")).prop("selected",true);var that=this;var getSecondlyPayModal=function(result){};var aBrowser=["webkitTransition","mozTransition","msTransition","transition"];var isTransition=false;var isBrowser="";for(var i=0,len=aBrowser.length;i<len;i++)if(aBrowser[i]in document.createElement("div").style){isTransition=true;isBrowser=aBrowser[i].replace(/transition/i,
"");break}$(".ui-tab").each(function(){var oPanel=$(this).find(".ui-tab-panel");var oLine=oPanel.find(".line");var aItem=oPanel.find('li:not(".line")');var aCont=$(this).find(".ui-tab-content");var fStyle=null;if(isTransition)fStyle=function(w,l){oLine.css({width:w,left:l})};else fStyle=function(w,l){oLine.stop(true,false).animate({width:w,left:l},300)};var start_w,start_l;aItem.each(function(num){var $this=$(this);var timer=null;$this.on("click","a",function(){start_w=$this.outerWidth();start_l=
$this.position().left;fStyle(start_w,start_l);$this.addClass("z-current").siblings("li").removeClass("z-current")})})});var channelUrl=_tabChannel;var channelDate=this.getUrlObject();var $container=this.$orderList.addClass("J-status-loading");$.ajax({url:channelUrl,data:channelDate}).fail(function(data){$container.removeClass("J-status-loading").addClass("J-status-fail")}).done(function(data){$container.removeClass("J-status-loading J-status-fail").html(data)});this.$orderList.on("click","#J-drop-menu li",
$.proxy(this.filter,this));var _self=this;this.$orderList.on("click",".J_list_retry",$.proxy(this.pageReload,this)).on("click",".J_retry",$.proxy(this.filter,this)).on("click",".J_delete",$.proxy(this.remove,this)).on("click",".J_pay",$.proxy(this.pay,this)).on("click",".J_merge",$.proxy(this.merge,this)).on("click",".J_modify",$.proxy(this.modify,this)).on("click",".J_return_cancel",$.proxy(this.returnGoodsCancel,this)).on("click",".J_rebuy",$.proxy(this.rebuy,this)).on("click",".J_saleago",$.proxy(this.receive,
this)).on("mouseenter",".J_track",$.proxy(this.track,this)).on("click",".J_cancel",function(e){that.cancel(e)}).on("click",".J_return",function(e){that.returnGoods(e)}).on("click",".J_vsc_cancel",function(e){that.vscGoodsCancel(e)}).on("click",".J_vsc_pay",function(e){that.vscGoodsPay(e)}).on("click",".J-vsc-verifiy",function(e){that.vscVerifiy(e)}).on("click",".J_vsccard_cancel",function(e){that.vsccardGoodsCancel(e)}).on("click",".J_vsccard_pay",function(e){that.vsccardGoodsPay(e)}).on("click",
".J-vsccard-verifiy",function(e){that.vsccardVerifiy(e)});this.modalPartInStock.element.on("click",".J_rebuy_stock",function(){var href=$(this).attr("href");var callback=$(this).data("callback");$.getJSON(href,function(res){if(res.code===200||res.result==1)location.href=callback;else that.alert(res.msg)});return false}).on("click",".J_rebuy_cancel",function(){location.reload()});this.modalAlert.element.on("click",".J_close",function(){location.reload()});this.modalNoStock.element.on("click",".J_close",
function(){location.reload()});var modalOnceMoreEl=this.modalOnceMore.element;modalOnceMoreEl.find(".ui-btn3").on("hover",function(){if(modalOnceMoreEl.hasClass("has-deal"))modalOnceMoreEl.find(".J_tooltip").toggle()});var modalCancelEl=this.modalCancel.element;var $question=modalCancelEl.find(".question");modalCancelEl.on("click",".J_ok",function(){if(modalCancelEl.find(":checked").length===0){var $tip=modalCancelEl.find(".u-pop-tips").show();setTimeout(function(){$tip.hide()},1500)}else{that.doCancel();
var okBtn=modalCancelEl.find(".J_ok");if(okBtn.hasClass("ui-btn-disable"))return;okBtn.addClass("ui-btn-disable")}}).on("click",".J_close",function(){modalCancelEl.find(":checked").prop("checked",false);modalCancelEl.find(".J_issue_pay").hide()});modalCancelEl.on("change","[type=radio]",function(){var $this=$(this);modalCancelEl.find(".ui-tips-pop").hide();if($this.is(":checked")){var $tip=$this.siblings(".ui-tips-pop");if($tip.is(".J_issue_info, .J_issue_coupon")&&cancelAdapter.modifyEnabled||$tip.is(".J_issue_pay")&&
cancelAdapter.payOnDelivery)$tip.show();$question.toggle($this.is("[id=reason7]"))}});var modalMergeEl=this.modalMerge.element;modalMergeEl.on("click",".J_ok",function(){if(modalMergeEl.find("[type=checkbox]:checked:not([disabled])").length===0){var $tip=modalMergeEl.find(".u-pop-tips").show();setTimeout(function(){$tip.hide()},1500)}else{that.modalMerge.hide();if(mergeAdapter.isCoupon)that.confirm(that.modalMergeConfirm,"",$.proxy(that.doMerge,that));else that.doMerge()}});this.modalMergeConfirm.element.on("click",
".J_close",function(){that.modalMerge.show()});this.$orderList.on("click",".J_uploadid",function(){var href=$(this).attr("href");window.open(template(href,{receiver:$(this).parents("tbody").data("receiver")}),"_blank");return false})},getUrlObject:function(){var url=location.href;var paraString=url.substring(url.indexOf("?")+1,url.length).split("&");var paraObj={tabChannel:"all"};for(var i=0;i<paraString.length;i++){var j=paraString[i];paraObj[j.substring(0,j.indexOf("="))]=j.substring(j.indexOf("=")+
1,j.length)}var $tabChannel=paraObj.tabChannel;if($tabChannel){var $channelTab=$("#J_channel_tab").find('li:not(".line")');var $tabChannelList=[];for(var i=0;i<$channelTab.length;i++)$tabChannelList.push($channelTab.eq(i).data("value"));var l=$.inArray(paraObj.tabChannel,$tabChannelList);$channelTab.eq(l).find("a").trigger("click")}return paraObj},pageReload:function(){location.reload()},getWalletStatus:function(){var that=this;$.getJSON(Config.wallet,function(res){that.walletStatus=res.walletstatus||
false})},alert:function(message){this.modalAlert.element.find(".J_message").html(message);this.modalAlert.show()},verifyAlert:function(message){this.modalVerifyAlert.element.find(".J_message").html(message);this.modalVerifyAlert.show()},confirm:function(modal,message,cb){if(message)modal.element.find(".J_message").text(message);modal.show();if(cb)modal.element.find(".J_ok").off("click").on("click",cb)},params:function(adapter,el){var $tbody=$(el).parents("tbody");var hasOwn=Object.prototype.hasOwnProperty;
for(var k in adapter.params)if(hasOwn.call(adapter.params,k))adapter.params[k]=$tbody.data(k)},countdown:function(modal,message,count,cb){var el=modal.element;var $count=el.find(".J_count");el.find(".J_message").html(message);count=count?parseInt(count,10):parseInt($count.html(),10);count=count>0?count:1;$count.html(count);modal.show();var timeid=setInterval(function(){$count.html(--count);if(count<0){modal.hide();clearInterval(timeid);cb&&cb()}},1E3);if(cb&&!modal.binded){modal.element.on("click",
".J_close",cb);modal.binded=true}},iconCountdown:function(modal,message,icon_num,count,cb){var el=modal.element;var $count=el.find(".J_count");if(parseInt(icon_num)>0)el.find(".J_icon_num").text("\u8ba2\u5355\u5408\u5e76\u6210\u529f\uff0c\u5b8c\u6210\u540e\u53ef\u83b7"+parseInt(icon_num)+"\u4e2a\u552f\u54c1\u5e01");else el.find(".J_icon_num").text("\u8ba2\u5355\u5df2\u5408\u5e76\u6210\u529f");el.find(".J_message").text(message);count=count?parseInt(count,10):parseInt($count.html(),10);count=count>
0?count:1;$count.html(count);modal.show();var timeid=setInterval(function(){$count.html(--count);if(count<0){modal.hide();clearInterval(timeid);cb&&cb()}},1E3);if(cb&&!modal.binded){modal.element.on("click",".J_close",cb);modal.binded=true}},filter:function(e){var li_status=$(e.currentTarget).find("a");var status=li_status.data("value");var $channelTab=$("#J_channel_tab");var channel=$channelTab.find(".z-current").data("value");var $container=this.$orderList.addClass("status-loading");var li_status_html=
li_status.html(),li_status_title=li_status.attr("title");var params={"tabChannel":channel,"status":status};$(".order-status").find(".J_retry").closest("tr").hide().end().end().find(".empty-tips").hide();$.ajax({url:Config.getOrderListTab,data:params,timeout:5E3}).fail(function(){$container.removeClass("status-loading").addClass("status-fail");$(".order-status").find(".J_retry").closest("tr").show().end().end().find(".empty-tips").hide()}).done(function(data){$container.removeClass("status-loading status-fail").html(data);
$("#J-drop-title").attr("title",li_status_title).html(li_status_html)})},pay:function(e){this.params(payAdapter,e.target);$.getJSON(payAdapter.api,payAdapter.params,$.proxy(this.renderPay,this))},merge:function(e){this.params(mergeAdapter,e.target);$.getJSON(mergeAdapter.api,mergeAdapter.params,$.proxy(this.renderMerge,this))},doMerge:function(){var $confirmBtn=this.modalMergeConfirm.element.find(".J_ok");if($confirmBtn.hasClass("ui-btn-disable"))return;$confirmBtn.addClass("ui-btn-disable");doMergeAdapter.params.codappAccount=
mergeAdapter.payType===mergeAdapter.DELIVERY_ALIPAY_POS?this.modalMerge.element.find("[type=radio]:checked").val():"";doMergeAdapter.params.codType=this.modalMerge.element.find("[type=radio]:checked").val();var subSnList=[];this.modalMerge.element.find("[name=order-sn]:checked").each(function(){subSnList.push($(this).val())});doMergeAdapter.params.snList=subSnList.join(",");doMergeAdapter.params.codType=this.modalMerge.element.find("[type=radio]:checked").val();$.getJSON(doMergeAdapter.api,doMergeAdapter.params,
$.proxy(this.renderMergeDone,this))},modify:function(e){this.params(modifyAdapter,e.target);$.ajax({url:modifyAdapter.api,data:modifyAdapter.params,async:false,dataType:"jsonp"}).always($.proxy(function(data){if(!this.renderModify.call(this,data)){e.preventDefault();e.stopPropagation();return false}},this))},cancel:function(e){this.params(cancelAdapter,e.target);this.reviewUrl=$(e.target).parents("tbody").find(".num a").attr("href");this.orderid=$(e.target).parents("tbody").data("orderid");this.sn=
$(e.target).parents("tbody").data("ordersn");var that=this;$.getJSON(cancelAdapter.api,cancelAdapter.params).done(function(data){if(data.code==555)that.confirm(that.modalWalletWarning,"",function(){var setPay=new SetPayPwd({isBg:true,hasPhoneTip:false,show:true,finish:function(){$.getJSON(cancelAdapter.api,cancelAdapter.params,$.proxy(that.renderCancel,that))}})});else that.renderCancel.call(that,data)})},doCancel:function(){var el=this.modalCancel.element;var $question=el.find(".question");doCancelAdapter.params.ordersn=
cancelAdapter.params.ordersn;doCancelAdapter.params.reasonChoice=el.find("[type=radio]:checked").val();doCancelAdapter.params.reasonRemark=$question.is(":hidden")?"":$question.val();$.getJSON(doCancelAdapter.api,doCancelAdapter.params,$.proxy(this.renderCancelDone,this))},remove:function(e){var that=this;this.confirm(this.modalConfirm,"\u786e\u5b9a\u8981\u5220\u9664\u6b64\u8ba2\u5355\u5417\uff1f",function(){that.params(removeAdapter,e.target);$.getJSON(removeAdapter.api,removeAdapter.params,$.proxy(that.renderRemove,
that))})},receive:function(e){var that=this;this.confirm(this.modalConfirm,"\u786e\u5b9a\u5df2\u6536\u5230\u5546\u54c1\u5305\u88f9\u5417\uff1f",function(){that.params(receiptAdapter,e.target);$.getJSON(receiptAdapter.api,receiptAdapter.params,$.proxy(that.renderReceive,that))})},returnGoods:function(e){var that=this;this.params(returnAdapter,e.target);$.getJSON(returnAdapter.api,returnAdapter.params).done(function(data){if(data.code==555)that.confirm(that.modalWalletWarning,"",function(){var setPay=
new SetPayPwd({isBg:true,hasPhoneTip:false,show:true,finish:function(){$.getJSON(returnAdapter.api,returnAdapter.params,$.proxy(that.renderReturn,that))}})});else that.renderReturn.call(that,data)})},returnGoodsCancel:function(e){this.params(returnCancelAdapter,e.target);var that=this;var modal_comfire=this.modalReturnComfire;modal_comfire.show();this.modalReturnComfire.element.off("click.retrun_confirm");this.modalReturnComfire.element.on("click.retrun_confirm",".J_retrun_confirm",function(){modal_comfire.hide();
$.getJSON(returnCancelAdapter.api,returnCancelAdapter.params,$.proxy(that.renderReturnCancel,that))})},vscGoodsCancel:function(e){var that=this;var modal_comfire=this.modalVscComfire;modal_comfire.show();this.modalVscComfire.element.off("click.retrun_confirm");this.modalVscComfire.element.on("click.retrun_confirm",".J_confirm",function(){var params={orderId:$(e.target).parents("tbody").data("orderid")};$.post(Config.cancelOrder,params).then(function(data){if(data.code===200)window.location.reload();
else{modal_comfire.hide();that.alert(data.msg)}})})},vscGoodsPay:function(e){var that=this;var params={orderId:$(e.target).parents("tbody").data("orderid")};$.post(Config.vscPayCheck,params).then(function(data){if(data.code===200)window.location.href="https://vrpay.vip.com/pay/getVCashier?orderId="+$(e.target).parents("tbody").data("orderid");else if(data.code===501)that.countdown(that.modalCountdown,"\u62b1\u6b49\uff0c\u60a8\u7684\u8ba2\u5355\u5df2\u88ab\u53d6\u6d88",5,function(){location.reload()});
else that.verifyAlert(data.msg)})},vscVerifiy:function(e){if(!$(e.target).hasClass("ui-btn-disable")){var that=this;var params={orderId:$(e.target).parents("tbody").data("orderid")};$.post(Config.vscVerifiyUrl,params).then(function(data){if(data.code===200){$(e.target).addClass("ui-btn-disable").html('<b style="color:#f10180;">60</b>S\u540e\u53ef\u91cd\u53d1');var sec=60;var callself=function(){if(sec!==0){$(e.target).find("b").html(sec);sec=sec-1;setTimeout(callself,1E3)}else $(e.target).html("\u53d1\u9001\u9a8c\u8bc1\u7801").removeClass("ui-btn-disable")};
callself();that.verifyAlert("\u9a8c\u8bc1\u7801\u5df2\u53d1\u9001\u81f3\u8054\u7cfb\u4eba\u624b\u673a<br>\u8bf7\u6ce8\u610f\u67e5\u6536")}else if(data.code===501){$(e.target).addClass("ui-btn-disable");that.verifyAlert("\u62b1\u6b49\uff0c\u6bcf\u5929\u53ea\u80fd\u83b7\u53d63\u6b21\u9a8c\u8bc1\u7801")}else that.verifyAlert(data.msg)})}},vsccardVerifiy:function(e){if(!$(e.target).hasClass("ui-btn-disable")){var that=this;var params={orderId:$(e.target).parents("tbody").data("orderid")};$.post(Config.vsccardVerifiyUrl,
params).then(function(data){if(data.code===200){$(e.target).addClass("ui-btn-disable").html('<b style="color:#f10180;">60</b>S\u540e\u53ef\u91cd\u53d1');var sec=60;var callself=function(){if(sec!==0){$(e.target).find("b").html(sec);sec=sec-1;setTimeout(callself,1E3)}else $(e.target).html("\u53d1\u9001\u5151\u6362\u7801").removeClass("ui-btn-disable")};callself();that.verifyAlert("\u5151\u6362\u7801\u5df2\u53d1\u9001\u81f3\u8054\u7cfb\u4eba\u624b\u673a<br>\u8bf7\u6ce8\u610f\u67e5\u6536")}else if(data.code===
501){$(e.target).addClass("ui-btn-disable");that.verifyAlert("\u62b1\u6b49\uff0c\u6bcf\u5929\u53ea\u80fd\u83b7\u53d63\u6b21\u5151\u6362\u7801")}else that.verifyAlert(data.msg)})}},vsccardGoodsCancel:function(e){var that=this;var modal_comfire=this.modalVscComfire;modal_comfire.show();this.modalVscComfire.element.off("click.retrun_confirm");this.modalVscComfire.element.on("click.retrun_confirm",".J_confirm",function(){var params={orderId:$(e.target).parents("tbody").data("orderid")};$.post(Config.vsccardCancelOrder,
params).then(function(data){if(data.code===200)window.location.reload();else{modal_comfire.hide();that.alert(data.msg)}})})},vsccardGoodsPay:function(e){var that=this;var params={orderId:$(e.target).parents("tbody").data("orderid")};$.post(Config.vsccardPayCheck,params).then(function(data){if(data.code===200)window.location.href="https://vrpay.vip.com/pay/getVCashier?isCard=1&orderId="+$(e.target).parents("tbody").data("orderid");else if(data.code===501)that.countdown(that.modalCountdown,"\u62b1\u6b49\uff0c\u60a8\u7684\u8ba2\u5355\u5df2\u88ab\u53d6\u6d88",
5,function(){location.reload()});else that.verifyAlert(data.msg)})},track:function(e){var $track=$(e.target);if($track.find(".J_track_list li").length===0){var that=this;$track.addClass("status-loading");this.params(trackAdapter,$track);$.getJSON(trackAdapter.api,trackAdapter.params,function(res){that.renderTrack.call(that,$track,res)})}},rebuy:function(e){var that=this;this.params(rebuyAdapter,e.target);var data=rebuyAdapter.params;if(data.independentorder){var fromStr;if(data.ordermodel==1)fromStr=
"prepay";else fromStr="global";var _data={num:data.sizeamount,size_id:data.sizeid,from:fromStr};$.ajax({url:rebuyAdapter.newapi,data:_data,dataType:"jsonp",success:function(res){if(res.code===200)location.href=res.redirect;else that.alert(data.msg)}})}else $.getJSON(rebuyAdapter.api,data,function(res){var result=rebuyAdapter.get(res);if(result.code===rebuyAdapter.SUCCESS)$.getJSON(result.redirect+"&client_time="+Math.floor((new Date).getTime()/1E3),function(res){if(res.code===200||res.result==1)location.href=
result.callback;else that.alert(res.msg)});else that.alert(result.msg)})},renderPay:function(res){var result=payAdapter.get(res);this.modalOnceMore.element.find(".J_pay_sn_tpl").each(function(){var href=$(this).attr("href");$(this).attr("href",template(href,{sn:payAdapter.params.ordersn}))});switch(result.code){case payAdapter.DONE:case payAdapter.CANCELED:this.alert(result.msg);break;case payAdapter.ONCEMORE_DEAL:this.modalOnceMore.element.removeClass(this.onceMoreStates).addClass("has-deal");this.modalOnceMore.show();
break;case payAdapter.ONCEMORE_NO_DEAL:this.modalOnceMore.element.removeClass(this.onceMoreStates).addClass("has-no-deal");this.modalOnceMore.show();break;case payAdapter.ONCEMORE_NOT_ON_DELIVERY:this.modalOnceMore.element.removeClass(this.onceMoreStates).addClass("has-no-delivery");this.modalOnceMore.show();break;case payAdapter.SUCCESS:if(result.hasOtherType)this.modalOnceMore.element.removeClass("no-other-type");else this.modalOnceMore.element.addClass("no-other-type");if(result.fromMobile){this.modalOnceMore.element.find(".ui-btn2").attr("href",
result.otherPayUrl);this.modalOnceMore.element.addClass("from-mobile")}else this.modalOnceMore.element.removeClass("from-mobile");if(result.cashAble){this.modalOnceMore.element.find("#other-type-link").addClass("u-order-pay");this.modalOnceMore.element.removeClass("has-no-delivery")}else{this.modalOnceMore.element.find("#other-type-link").removeClass("u-order-pay");this.modalOnceMore.element.addClass("has-no-delivery")}if(result.hasDeal)this.modalOnceMore.element.addClass("has-deal").removeClass("has-no-deal");
else this.modalOnceMore.element.addClass("has-no-deal").removeClass("has-deal");if(result.otherPayUrl)this.modalOnceMore.element.find("#other-type-link a").attr("href",result.otherPayUrl);if(result.mobilePayResult)this.modalOnceMore.element.removeClass("cash-only");else this.modalOnceMore.element.addClass("cash-only");this.modalOnceMore.show();break;case payAdapter.MOBILE_ONLY:this.modalOnceMoreMobileOnly.show();break;case payAdapter.NO_STOCK:this.modalNoStock.show();break;case payAdapter.PART_IN_STOCK:var noStockList=
result.noStockList;var stockList=result.stockList;var $tbody=this.modalPartInStock.element.find("tbody").empty();var i,item,html=[];for(i=noStockList.length;i--;){item=noStockList[i];item.stateClass=item.amount>0?"status-remain":"status-sold";html.push(template(this.payStockTpl,item))}for(i=stockList.length;i--;){item=stockList[i];item.stateClass=item.amount<item.goodsCount?"status-remain":"status-normal";html.push(template(this.payStockTpl,item))}$tbody.html(html.join(""));this.modalPartInStock.element.find(".J_rebuy_stock").data("callback",
result.callback).attr("href",result.redirect);this.modalPartInStock.show();break;default:this.alert(result.msg)}},renderMerge:function(res){var result=mergeAdapter.get(res);switch(result.code){case mergeAdapter.CANCELED:case mergeAdapter.REFUSED:this.alert(result.msg);break;case mergeAdapter.EMPTY:this.modalMergeEmpty.show();break;case mergeAdapter.OK:var $tbody=this.modalMerge.element.find("tbody").empty();var item=result.main;item.money=+item.money+ +item.surplus+ +item.virtual_money;if(!/\.\d+/.test(item.money))item.money+=
".00";var $row=$(template(this.mergeRowTpl,item));$row.find("[type=checkbox]").attr("checked","checked").attr("disabled","disabled").attr("name","main-order-sn");$row.children("td").eq(1).append('<p class="gray">\u4e3b\u8ba2\u5355</p>');$tbody.append($row);doMergeAdapter.params.mainSn=item.order_sn;doMergeAdapter.params.codType=mergeAdapter.payType;var i;for(i=result.orders.length;i--;){item=result.orders[i];item.money=+item.money+ +item.surplus+ +item.virtual_money;if(!/\.\d+/.test(item.money))item.money+=
".00";$row=$(template(this.mergeRowTpl,item));$tbody.append($row)}var el=this.modalMerge.element.removeClass(this.payTypeStates.all);var typeState=this.payTypeStates[result.payType];if(typeState)el.addClass(typeState);var alipayList=result.alipayList;this.modalMerge.element.find(".m-pay").find("[name=pay-kind]").eq(0).prop("checked",true);var $alipayList=this.modalMerge.element.find(".J_alipay_list").empty();var $mPay=this.modalMerge.element.find(".m-pay");$mPay.find("[type=radio]").on("click",function(evt){var $tar=
$(evt.target);if($tar.prop("name")==="pay-kind")if($tar.prop("id")==="alipay")$mPay.find("[name=alipay-kind]").eq(0).prop("checked",true);else $mPay.find("[name=alipay-kind]").prop("checked",false)});for(i=0;i<alipayList.length;i++){$row=$(template(i===0?this.mergeAlipayFirstTpl:this.mergeAlipayTpl,alipayList[i]));$alipayList.append($row);$alipayList.show();$row.on("click",function(evt){var $tar=$(evt.target);$mPay.find("[id=alipay]").prop("checked",true)})}this.modalMerge.show();break;default:this.alert(result.msg)}},
renderMergeDone:function(res){this.modalMerge.hide();this.modalMergeConfirm.hide();var result=doMergeAdapter.get(res);switch(result.code){case doMergeAdapter.SUCCESS:if(result.msg)this.iconCountdown(this.modalMergeSuccessWithMessage,result.msg,res.point,5,function(){location.reload()});else{var J_iconNum_txt;if(parseInt(res.point)>0)J_iconNum_txt="\u8ba2\u5355\u5408\u5e76\u6210\u529f\uff0c\u5b8c\u6210\u540e\u53ef\u83b7"+parseInt(res.point)+"\u4e2a\u552f\u54c1\u5e01";else J_iconNum_txt="\u8ba2\u5355\u5df2\u5408\u5e76\u6210\u529f";
this.countdown(this.modalMergeSuccess,J_iconNum_txt,5,function(){location.reload()})}break;case doMergeAdapter.FEFUN_FAIL:this.confirm(this.modalMergePaybackFail,result.msg,function(){location.reload()});this.modalMergePaybackFail.element.on("click",".J_close",function(){location.reload()});break;default:this.alert(result.msg)}},renderModify:function(res){var result=modifyAdapter.get(res);switch(result.code){case modifyAdapter.CANCELED:case modifyAdapter.DISABLED:this.alert(result.msg);break;case modifyAdapter.OK:return true;
default:this.alert(result.msg)}},renderCancel:function(res){var result=cancelAdapter.get(res);var that=this;switch(result.code){case cancelAdapter.CANCELED:case cancelAdapter.DISABLED:this.alert(result.msg);break;case cancelAdapter.OK:this.modalCancel.show();this.modalCancel.element.find(".J_review").attr("href",this.reviewUrl);var $modifyLink=this.modalCancel.element.find(".J_modify_link");$modifyLink.each(function(){var href=$(this).attr("href");$(this).attr("href",template(href,{orderid:that.orderid,
sn:that.sn}))});break;default:this.alert(result.msg)}},renderCancelDone:function(res){var result=doCancelAdapter.get(res);this.modalCancel.hide();this.modalCancel.element.find("[type=radio]").prop("checked",false).end().find("[name=any-question]").hide();switch(result.code){case doCancelAdapter.SUCCESS:var return_type_text="";if(result.result&&result.result.return_type)switch(parseInt(result.result.return_type)){case 2:return_type_text="\u53d6\u6d88\u8ba2\u5355\u540e\uff0c\u94b1\u6b3e\u5c06\u6309\u7167\u60a8\u9ed8\u8ba4\u7684\u9000\u6b3e\u8def\u5f84 \u9000\u56de\u94b1\u5305";
break;case 1:return_type_text="\u53d6\u6d88\u8ba2\u5355\u540e\uff0c\u94b1\u6b3e\u5c06\u6309\u7167\u60a8\u9ed8\u8ba4\u7684\u9000\u6b3e\u8def\u5f84 \u539f\u8def\u9000\u56de";break;default:return_type_text=""}this.countdown(this.modalCancelSuccess,return_type_text,5,function(){location.reload()});this.modalCancelSuccess.element.find(".info").toggle(!!$.trim(return_type_text));if(result.result&&result.result.pms_flag==0)this.modalCancelSuccess.element.find(".coupon_notice").html("\u5f53\u524d\u4f7f\u7528\u7684\u793c\u5238\u8fd8\u6709\u5176\u5b83\u8ba2\u5355\u4eab\u53d7\u4f18\u60e0\uff0c\u6682\u4e0d\u9000\u56de");
break;default:this.alert(result.msg)}},renderRemove:function(res){var result=removeAdapter.get(res);switch(result.code){case removeAdapter.SUCCESS:this.countdown(this.modalCountdown,res.msg,5,function(){location.reload()});break;default:this.alert(result.msg)}},renderReturn:function(res){var result=returnAdapter.get(res);switch(result.code){case returnAdapter.REFUSED:case returnAdapter.REPEAT:this.alert(result.msg);break;case returnAdapter.SUCCESS:location.href=result.redirect;break;default:this.alert(result.msg)}},
renderReturnCancel:function(res){var result=returnCancelAdapter.get(res);switch(result.code){case returnCancelAdapter.CANCELED:case returnCancelAdapter.DISABLED:this.alert(result.msg);break;case returnCancelAdapter.SUCCESS:this.countdown(this.modalCountdown,"\u8ba2\u5355\u5df2\u6210\u529f\u53d6\u6d88\u9000\u8d27",5,function(){location.reload()});break;default:this.alert(result.msg)}},renderTrack:function($track,res){var result=trackAdapter.get(res);var $list=$track.find(".J_track_list");$track.removeClass("status-loading");
switch(result.code){case trackAdapter.SUCCESS:var list=result.list;var $ul=$("<ul/>");var i;for(i=list.length;i--;){var item=list[i];$ul.append($("<li/>").append('<span class="time">'+item.time+"</span>").append('<span class="info">'+item.remark+"</span>"))}$track.removeClass("status-fail");$list.empty().append($ul);break;default:$track.addClass("status-fail")}},renderReceive:function(res){var result=receiptAdapter.get(res);switch(result.code){case receiptAdapter.OK:location.reload();break;default:this.alert(result.msg)}}};
var Guide={init:function(){this.disabled=$.Cookie.get("isGuideDisabled");if(this.disabled)return;this.maskZindex=1040;this.step=0;this.stepModals=[new Modal({element:"#J_new_guide_step1",centered:false}),new Modal({element:"#J_new_guide_step2",centered:false})];this.show();var $guides=$(),i;for(i=this.stepModals.length;i--;)$guides=$guides.add(this.stepModals[i].element);$guides.on("click",".close",$.proxy(this.close,this)).on("click",".next",$.proxy(this.next,this))},show:function(step){this.step=
typeof step==="number"?step:this.step;var stepModal=this.stepModals[this.step];stepModal.element.css("z-index",this.maskZindex+1);stepModal.show()},close:function(){this.stepModals[this.step].hide();$.Cookie.set("isGuideDisabled",1,"","/",24*365);$(".J_declare").show()},next:function(){var next=this.step+1;this.close(this.step);if(next<this.stepModals.length){this.show(next);$(".J_declare").show()}}};var afterInited=function(){var searchParts=location.hash.replace("#","").split("&");var mMap={};for(var i=
0;i<searchParts.length;i++){var pair=searchParts[i].split("=");mMap[pair[0]]=pair[1]}var $orderItem=$("[data-ordersn="+mMap.ordersn+"]");if(mMap.act==="codCheck")$orderItem.find(".J_pay").trigger("click");else if(mMap.act==="saleAgo")$orderItem.find(".J_saleago").trigger("click");else if(mMap.act==="rebuy")$orderItem.find(".J_rebuy").trigger("click")};$(function(){Order.init();afterInited();var addArray;if(location.href.match("returnlist"))addArray=["ADS5LAA8","ADSL6SNX","ADS4DPM2"];else addArray=
["ADS5LAA8","ADSL6SNX","ADS4DPM2"];Ads.init(addArray).fetch(function(){var $ads=$("#J_adads5laa8");if($ads.children().length<=1)return;var sec=0,slildeSet;var slide=function(){$ads.children().eq(sec++%$ads.children().length).show().siblings().hide();slildeSet=setTimeout(slide,3E3)};slide();$ads.hover(function(){clearTimeout(slildeSet)},function(){slildeSet=setTimeout(slide,3E3)})});window.Order=Order;$(document).on("click",function(evt){var $src=$(evt.target||event.srcElement);if($src.closest("#J_dropdown_filter").length>
0||$src.attr("id")==="J_dropdown_filter")return;if($("#J_dropdown_filter").hasClass("u-select-active"))$("#J_dropdown_filter").removeClass("u-select-active")})})},{"./modules/ads":2,"./modules/list/cancel-adapter":3,"./modules/list/do-cancel-adapter":4,"./modules/list/do-merge-adapter":5,"./modules/list/merge-adapter":6,"./modules/list/modify-adapter":7,"./modules/list/pay-adapter":8,"./modules/list/rebuy-adapter":9,"./modules/list/receipt-adapter":10,"./modules/list/remove-adapter":11,"./modules/list/return-adapter":12,
"./modules/list/return-cancel-adapter":13,"./modules/list/template":14,"./modules/list/track-adapter":15,"./modules/modal":16}],2:[function(require,module,exports){var template=require("./template");module.exports={api:"http://pcapi.vip.com/ads/index.php?callback=?",init:function(ids){this.ids=ids;return this},fetch:function(cb){var that=this;$.getJSON(this.api,{type:this.ids.join(","),channelId:0,warehouse:0},function(res){that.render(res,cb)})},render:function(res,cb){for(var k in res){var items=
res[k].items,i,len=items.length,slotName=k.toLowerCase(),$slot=$("#J_"+slotName).empty(),adTpl=$("#J_"+slotName+"_tpl").html()||$("#J_ad_tpl").html();for(i=0;i<len;i++){var item=items[i];var $item=$(template(adTpl,item));if(!item.link)if($item.is("a"))$item.removeAttr("href");else $item.find("a").removeAttr("href");else if(item.blank)if($item.is("a"))$item.attr("target","_blank");else $item.find("a").attr("target","_blank");$slot.append($item)}}if(cb&&typeof cb==="function")cb()}}},{"./template":17}],
3:[function(require,module,exports){module.exports={api:"/order/cancelOrder?callback=?",CANCELED:1,DISABLED:2,OK:200,params:{ordersn:""},get:function(res){return $.extend(this,{code:res.code,msg:res.msg,modifyEnabled:res.result.modifyEnabled,payOnDelivery:res.result.payOnDelivery})}}},{}],4:[function(require,module,exports){module.exports={api:"/order/updateCancelOrder?callback=?",SUCCESS:200,params:{ordersn:"",reasonChoice:"",reasonRemark:""},get:function(res){return{code:res.code,msg:res.msg,result:res.result}}}},
{}],5:[function(require,module,exports){module.exports={api:"/order/updateMergeOrder?callback=?",SUCCESS:200,FEFUN_FAIL:3133,params:{snList:"",mainSn:"",customersrc:"",codType:"",codappAccount:""},get:function(res){return{code:res.code,msg:res.msg}}}},{}],6:[function(require,module,exports){module.exports={api:"/order/getMergeOrderList?callback=?",CANCELED:1,REFUSED:2,EMPTY:4,OK:200,DELIVERY_NO_ALIPAY:5,DELIVERY_ALL_AVAILABLE:6,DELIVERY_NO_POS:7,params:{ordersn:""},get:function(res){return $.extend(this,
{code:res.code,msg:res.msg,main:res.result.main,orders:res.result.orders,isCoupon:res.result.isCoupon,payType:res.result.userPayType,alipayList:res.result.taobaoMap||[]})}}},{}],7:[function(require,module,exports){module.exports={api:"/order/modifyOrder?callback=?",CANCELED:1,DISABLED:2,OK:200,params:{ordersn:""},get:function(res){return{code:res.code,msg:res.msg,redirect:res.result.redirect}}}},{}],8:[function(require,module,exports){module.exports={api:"/pay/codCheck?callback=?",MOBILE_ONLY:12,
DONE:1,CANCELED:2,ONCEMORE_DEAL:7,ONCEMORE_NO_DEAL:3,ONCEMORE_NOT_ON_DELIVERY:4,PART_IN_STOCK:5,NO_STOCK:6,SUCCESS:200,params:{ordersn:"",money:"",areaCode:"",mobile:"",tel:""},get:function(res){var hasOtherType=false;var fromMobile=false;var cashAble=false;var isTe=false;var code=res.code;var hasDeal=false;if(code===this.SUCCESS)if(res.result.payResult){cashAble=res.result.cashResult;hasOtherType=res.result.channel==0||res.result.channel==1;fromMobile=res.result.clientType==2;hasDeal=res.result.exPaySubtotal>
0}else code=this.PART_IN_STOCK;return{hasDeal:hasDeal,cashAble:cashAble,hasOtherType:hasOtherType,fromMobile:fromMobile,code:code,msg:res.msg,stockList:res.result.stockList,noStockList:res.result.noStockList,redirect:res.result.redirect,callback:res.result.callback,otherPayUrl:res.result.otherPayUrl,clientType:res.result.clientType,channel:res.result.channel,mobilePayResult:res.result.mobilePayResult}}}},{}],9:[function(require,module,exports){module.exports={api:"/order/rebuy?callback=?",newapi:"http://checkout.vip.com/te2/buyCheck.php",
SUCCESS:200,params:{ordersn:"",independentorder:"",ordermodel:"",sizeid:"",sizeamount:""},get:function(res){return{code:res.code,msg:res.msg,redirect:res.result.redirect,callback:res.result.callback,channel:res.result.channel}}}},{}],10:[function(require,module,exports){module.exports={api:"/order/saleAgo?callback=?",OK:200,params:{ordersn:""},get:function(res){return{code:res.code,msg:res.msg}}}},{}],11:[function(require,module,exports){module.exports={api:"/order/deleteOrder?callback=?",SUCCESS:200,
params:{ordersn:""},get:function(res){return{code:res.code,msg:res.msg}}}},{}],12:[function(require,module,exports){module.exports={api:"/order/returnedOrder?callback=?",REFUSED:1,REPEAT:2,SUCCESS:200,params:{ordersn:""},get:function(res){return{code:res.code,msg:res.msg,redirect:res.result.redirect}}}},{}],13:[function(require,module,exports){module.exports={api:"/order/updateCancelReturnedOrder?callback=?",CANCELED:1,DISABLED:2,SUCCESS:200,params:{ordersn:""},get:function(res){return{code:res.code,
msg:res.msg}}}},{}],14:[function(require,module,exports){module.exports=function(tpl,values){return tpl.replace(/\{\{\s*(.+?)\s*\}\}/g,function(m,v){return values[v]||""})}},{}],15:[function(require,module,exports){module.exports={api:"/order/orderTrack?callback=?",SUCCESS:200,params:{ordersn:""},get:function(res){var list;if(res.result.getInfo.length)list=res.result.getInfo[0].timeline;else if(res.result.getInfo.timeline)list=res.result.getInfo.timeline;else for(var p in res.result.getInfo){list=
res.result.getInfo[p].timeline;break}return{code:res.code,list:list}}}},{}],16:[function(require,module,exports){function Modal(options){this.trigger=options.trigger?$(options.trigger):null;this.element=$(options.element);this.centered=typeof options.centered==="undefined"?true:options.centered;options.mask=typeof options.mask==="undefined"?true:options.mask;if(options.mask){var $mask=$("body").children(".pure-modal-backdrop");this.mask=$mask.length>0?$mask:$('<div class="pure-modal-backdrop"/>').appendTo("body");
this.mask.hide()}if(this.trigger)this.trigger.click($.proxy(this.show,this));this.element.on("click",".J_close",$.proxy(this.hide,this))}Modal.prototype.setElement=function(el){this.element=$(el);this.element.off("click",".J_close",$.proxy(this.hide,this)).on("click",".J_close",$.proxy(this.hide,this))};Modal.prototype.show=function(){this.element.show();var isIE6="undefined"==typeof document.body.style.maxHeight;if(this.centered)if(isIE6)this.element.css({top:$(document).scrollTop()+($(window).height()-
this.element.height())/2,position:"absolute"});else this.element.css({top:($(window).height()-this.element.height())/2,position:"fixed"});if(this.mask)if(isIE6)this.mask.css({position:"absolute",height:$(document).height()}).show();else this.mask.show()};Modal.prototype.hide=function(){this.element.hide();if(this.mask)this.mask.hide();return false};module.exports=Modal},{}],17:[function(require,module,exports){module.exports=require(14)},{}]},{},[1]);
