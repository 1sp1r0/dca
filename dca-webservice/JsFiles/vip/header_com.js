(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);throw new Error("Cannot find module '"+o+"'");}var f=n[o]={exports:{}};t[o][0].call(f.exports,function(e){var n=t[o][1][e];return s(n?n:e)},f,f.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){document.domain=/\.vipglobal\.hk$/.test(window.location.hostname)?
"vipglobal.hk":"vip.com";var navMod=require("./modules/header/navMod.js");var WhChoose=require("./modules/header/WhChooseMod.js");var HeadInfo=require("./modules/header/headInfo.js");var CartMod=require("./modules/header/CartMod.js");var UnpayTip=require("./modules/header/UnpayTipMod.js");var PrePay=require("./modules/header/PrePayMod.js");var VIPTE=window.VIPTE||{};VIPTE.nsCart=window.nsCart=CartMod;VIPTE.nsHead={init:function(){HeadInfo.init()}};VIPTE.nsWhChoose={init:function(){WhChoose.init({whChangeJump:false})}};
VIPTE.nsUnpayOrder={init:function(){if(typeof VIPTE!="undefined")UnpayTip.init()}};VIPTE.nsPrePay={init:function(){PrePay.init()}};$(function(){navMod.init();$.Listeners.sub("ready.second").onsuccess(function(){VIPSHOP.member.chk();VIPTE.nsCart.init();VIPTE.nsHead.init()});$.Listeners.sub("ready.third").onsuccess(function(){VIPTE.nsUnpayOrder.init();VIPTE.nsPrePay.init();if(navigator.cookieEnabled)VIPTE.nsWhChoose.init()})})},{"./modules/header/CartMod.js":3,"./modules/header/PrePayMod.js":4,"./modules/header/UnpayTipMod.js":5,
"./modules/header/WhChooseMod.js":6,"./modules/header/headInfo.js":8,"./modules/header/navMod.js":9}],2:[function(require,module,exports){var nsCartData={url:VIPSHOP.cartHost+"/cart.php",events:{askSuccess:"cart.askInfo.success",askFail:"cart.askInfo.fail",askLogin:"cart.ask.login"},getScript:function(paramObj,type){var paramData={},_this=this;for(var key in paramObj)paramData[key]=paramObj[key];switch(type){case 1:_this.url=VIPSHOP.cartHost+"/getCartList.php";break;default:_this.url=_this.url;break}$.ajax({url:_this.url,
data:paramData,dataType:"jsonp",timeout:6E3,success:function(re){var eventType=nsCartData.events.askSuccess;if(re.result==1&&type)switch(re.code){case 200:eventType=nsCartData.events.askSuccess;break;default:eventType=nsCartData.events.askFail;break}if(re.result==-1)eventType=nsCartData.events.askLogin;$.Listeners.pub(eventType).success(re)},error:function(){$.Listeners.pub(nsCartData.events.askFail).success()}})}};module.exports=nsCartData},{}],3:[function(require,module,exports){var browserMod=
require("./browserMod.js"),nsCartData=require("./Cart.js"),isMobile=VIPSHOP.core3?VIPSHOP.Detect.mobile:VIPSHOP.isMobile,isGlobal=/\.vipglobal\.hk$/.test(window.location.hostname),hostName=isGlobal?".vipglobal.hk":".vip.com";var nsCart={guest_user:false,cartCount:0,skuCount:0,endTime:0,interval:null,cartTimeTipsShow:false,defCartTip:$("#J_headCartList_wrap").html(),hasAsidebar:false,left5Mark:false,left3Mark:false,isTimeout:true,rcabtCookie:parseInt(UINFO.parseCookie()["rcabt"])||0,isNewCart:function(){var isAbtestOrOld=
VIPSHOP.isRcabtFromABTEST?VIPSHOP.isRcabtFromABTEST:0;return isAbtestOrOld?this.rcabtCookie:0},status:"",cartEndTime:"",init:function(){var that=this,$J_headCartList_wrap=$("#J_headCartList_wrap"),isFreeReg=that.freeReg();window.nsCart=that;that.subEvent();this.loadScript();that.guest_user=!!$.Cookie.get("Guest_ID");this.addEvent();$.Listeners.pub("cart.init").success();if(!isFreeReg&&!$.Cookie.get("VipLID")){$J_headCartList_wrap.html($("#J_headCartUnLogin_tmp").html());return false}that.hasAsidebar=
$("#J_asideBar").length;that.defCartTip=$J_headCartList_wrap.html();that.render()},subEvent:function(){var that=this;$.Listeners.sub("cart.init","cart.exists").onsuccess(function(){var rt=VIPSHOP.core3===true?VIPSHOP.Time.fn_countDown(that.endTime):fn_CountDown(that.endTime);if(!(rt.sec=="0"&&rt.min=="0")){clearInterval(that.interval);that.interval=setInterval(that.countDown,1E3)}that.setCartCount(that.cartCount);$.Listeners.pub("cart.init").error()});$.Listeners.sub("cart.askInfo.success").onsuccess(function(re){var isNewCart=
that.isNewCart();if(isNewCart){if(!re.data.endTime)re.data.endTime=that.cartEndTime;else that.cartEndTime=re.data.endTime;$.crossStorage.set("cartInfoLS",re)}else $.crossStorage.set("cartInfoLS","");var outData=that.cartRtnDataHandle(re);that.cb&&that.cb(outData);that.getDataCb(outData);that.isTimeout=true;that.renderCb(outData);$.Listeners.pub("cart.askInfo.init.success").success(outData);$.Listeners.pub("cartData.toGet.success").success(outData)});$.Listeners.sub("cart.askInfo.fail").onsuccess(function(){that.status=
"done"});$.Listeners.sub("cart.ask.login").onsuccess(function(){$.Cookie.del("VipLID",hostName,"/");that.resetDefault();that.status="done"});$.Listeners.sub("cart.askInfo.init.success").onsuccess(function(){that.cb=null});$.Listeners.sub("cart.empty").onsuccess(function(){var isFreeReg=that.freeReg();that.endTime=0;$("#J_headCartList_wrap").html(that.defCartTip);$.Listeners.pub("cart.reset.success").success({num:0,open:false})});$.Listeners.sub("cart.reset.success").onsuccess(function(data){if(!data.open){$("#J_skuCount").html("0");
$("#J_shortTime").removeClass("cart-have-goods");$("#J-mycartText").html("\u6211\u7684\u8d2d\u7269\u888b");$("#J-mycartText-countdown").addClass("hidden")}});$.Listeners.sub("askCartInfo").onsuccess(function(){var isNewCart=that.isNewCart();nsCartData.getScript({isGetLast:1},isNewCart)});$.Listeners.sub("headCart.getScript.cartData").onsuccess(function(re){nsCart.get(re.cb,{isGetLast:1})});$.Listeners.sub("headCart.render.data").onsuccess(function(re){nsCart.renderCb(re.cartData)});$.Listeners.sub("getStorageCartData").onsuccess(function(re){var isNewCart=
that.isNewCart();if(!isNewCart||!re)return;var ncsData=that.cartRtnDataHandle(re);var cartNum=$("#J_head_cart_num").html();if(cartNum!=ncsData.cartList.sku_count)that.renderCb(ncsData);else $.Listeners.pub("cart.exists").success()});$.Listeners.sub("openCartClose").onsuccess(function(){$("#J_headCartList_wrap").remove();$("#J_skuCount_container").hide()});$.Listeners.sub("cartCrossStorageReady").onsuccess(function(){if(that.configCartCrossStorage.isCartData&&(that.configCartCrossStorage.isInfoLS&&
that.configCartCrossStorage.isDate)){that.crossOpen=true;$.Listeners.pub("checkCartIsAskCart").success();that.resetStorageCart()}});$.Listeners.sub("checkCartIsAskCart").onsuccess(function(){var cartData=that.configCartCrossStorage.cartData,cartInfoLS=that.configCartCrossStorage.cartInfoLS,cartDate=that.configCartCrossStorage.cartDate,cartKey=$.Cookie.get("VipCI_te"),whKey=$.Cookie.get("vip_wh"),login_username=$.Cookie.get("login_username").replace("@","---"),guestId=$.Cookie.get("VIPGuest_ID"),vipLid=
$.Cookie.get("VipLID"),isNewCart=that.isNewCart(),T=new Date,D=T.getDate(),isFreeReg=that.freeReg();if(isNewCart&&!cartInfoLS){$.Listeners.pub("getCartDataIsStorage").success({isAsk:false});return}if(guestId&&vipLid){$.Listeners.pub("getCartDataIsStorage").success({isAsk:false});return}if(!cartData){$.Listeners.pub("getCartDataIsStorage").success({isAsk:false});return}if(isGlobal||cartKey&&cartData.key!=cartKey){$.Listeners.pub("getCartDataIsStorage").success({isAsk:false});return}if(cartData.whKey!=
whKey){$.Listeners.pub("getCartDataIsStorage").success({isAsk:false});return}if(!isFreeReg&&cartData.login_username!=login_username){$.Listeners.pub("getCartDataIsStorage").success({isAsk:false});return}if(cartDate&&cartDate!=D){$.Listeners.pub("getCartDataIsStorage").success({isAsk:false});return}$.Listeners.pub("getCartDataIsStorage").success({isAsk:true})});$.Listeners.sub("getCartDataIsStorage").onsuccess(function(data){var cartData=that.configCartCrossStorage.cartData,cartInfoLS=that.configCartCrossStorage.cartInfoLS,
cartDate=that.configCartCrossStorage.cartDate,T=new Date,D=T.getDate(),isNewCart=that.isNewCart();if(data.isAsk){that.cb_bag(cartData);$.Listeners.pub("getCartData").success(cartData);$.Listeners.unsub("getCartData").success();if(cartData.cartInfo.end_time!=that.endTime)that.endTime=cartData.cartInfo.end_time;$.Listeners.pub("getStorageCartData").success(cartInfoLS);$.Listeners.pub("cartData.toGet.success").success(cartData)}else{if(cartDate!=D)$.crossStorage.set("cartDate",D);if(that.status!="loading"){that.status=
"loading";nsCartData.getScript(that.paramObj_bag,isNewCart);that.cb=that.cb_bag}}})},freeReg:function(){var parseVipUINFO=UINFO.parseCookie(),isFreeReg=parseVipUINFO.luc==="a"&&parseVipUINFO.p2==1;if(isFreeReg&&(!$.Cookie.get("VipRUID")&&$.Cookie.get("VIPGuest_ID")!=="0"))return true;return false},loadScript:function(){var self=this;$.Loader.advScript({name:"scrollbar",url:VIPSHOP.staticJs+"/plugins/perfect-scrollbar-0.4.8.with-mousewheel.min.js?"+VIPSHOP.jsVer},{name:"cartLoadSb",def:function(){self.scriptLoaded()},
requires:["scrollbar"]})},hasScrollbar:false,cartListShow:$.noop,cartListUpdate:$.noop,cartListRemove:$.noop,scriptLoaded:function(){var self=this;function createHandle(handle){return function(){var cartList=document.getElementById("J-cartList"),hasScrollbar=self.hasScrollbar;handle(cartList,hasScrollbar)}}self.cartListShow=createHandle(function(cartList,hasScrollbar){if(cartList){!hasScrollbar&&$(cartList).css({overflow:"hidden",position:"relative"}).perfectScrollbar();self.hasScrollbar=true}});
self.cartListUpdate=createHandle(function(cartList,hasScrollbar){if(cartList)hasScrollbar&&$(cartList).perfectScrollbar("update")});self.cartListRemove=createHandle(function(cartList,hasScrollbar){if(cartList){hasScrollbar&&$(cartList).perfectScrollbar("destroy");self.hasScrollbar=false}});self.cartListShow()},addEvent:$.noop,toLogin:function(){VIPSHOP.login.init()},render:$.noop,configCartCrossStorage:{cartData:{},cartInfoLS:{},cartDate:"",isCartData:false,isInfoLS:false,isDate:false},resetStorageCart:function(){var _this=
this;_this.configCartCrossStorage.isCartData=false;_this.configCartCrossStorage.isInfoLS=false;_this.configCartCrossStorage.isDate=false},getCartCrossStorage:function(){var _this=this;_this.crossOpen=false;$.crossStorage.get("cartData",function(cartData){_this.configCartCrossStorage.cartData=cartData;_this.configCartCrossStorage.isCartData=true;$.Listeners.pub("cartCrossStorageReady").success()});$.crossStorage.get("cartInfoLS",function(cartInfoLS){_this.configCartCrossStorage.cartInfoLS=cartInfoLS;
_this.configCartCrossStorage.isInfoLS=true;$.Listeners.pub("cartCrossStorageReady").success()});$.crossStorage.get("cartDate",function(cartDate){_this.configCartCrossStorage.cartDate=cartDate;_this.configCartCrossStorage.isDate=true;$.Listeners.pub("cartCrossStorageReady").success()})},crossOpen:true,get:function(cb,paramObj){var that=this,cartData={},isFreeReg=that.freeReg();if(that.status=="loading"||!that.crossOpen)$.Listeners.sub("getCartData").onsuccess(cb);else{that.cb_bag=cb;that.paramObj_bag=
paramObj}if(!VIPSHOP.openCartApi||!isFreeReg&&!$.Cookie.get("VipLID")){cartData={"cartInfo":{"end_time":"0","jit_type":0,"num":0,"has_supplier":0,"hasPreSale":0,"has_goods_left":true,"count_limit":10,"lifetime":0,"warehouse":""},"cartList":{"count":0,"sku_count":0,"total":987,"items":[{}]},"key":"0|0","login_username":""};cb(cartData);$.Listeners.pub("getCartData").success(cartData);$.Listeners.unsub("getCartData").success();return}that.getCartCrossStorage()},getDataCb:function(re){nsCart.status=
"done";if(!re)return;var cartKey=$.Cookie.get("VipCI_te"),login_username=$.Cookie.get("login_username").replace("@","---"),whKey=$.Cookie.get("vip_wh"),that=this;re.key=cartKey;re.login_username=login_username;re.whKey=whKey;if(re.result!=-1){$.crossStorage.set("cartData",re,180,function(){});$.Cookie.set("VipCI_te",cartKey,hostName,"/",0)}$.Listeners.pub("getCartData").success(re);$.Listeners.unsub("getCartData").success()},cartRtnDataHandle:function(re){var that=this,outData={},isNewCart=that.isNewCart();
switch(isNewCart){case 1:outData=that.sidebarOuterData(re.data);break;default:outData=re;break}return outData},sidebarOuterData:function(rtndata){var cartInfo={};var that=this;if(rtndata.endTime){cartInfo.end_time=rtndata.endTime;this.cartEndTime=rtndata.endTime}else cartInfo.end_time=this.cartEndTime;var cartList={};cartList.count=rtndata.cartList.count;cartList.sku_count=rtndata.cartList.sku_count;cartList.total=rtndata.cartList.total;var items=[];$.each(rtndata.cartList.supplier_list,function(key,
obj){if(obj&&obj.groups)$.each(obj.groups,function(idx,groups){$.each(groups.goods_list,function(index,goods_list){items.push(goods_list)})});if(obj&&obj.gift)$.each(obj.gift,function(index,gift){items.push(gift)})});cartList.items=items;return{cartInfo:cartInfo,cartList:cartList}},reset:function(){$.crossStorage.set("cartData",{},0,function(){});this.render();return this},setCartCount:function(num){var that=this;if(num>0){$(".J_cartCount").html(that.cartCount);$("#J_skuCount").html(that.skuCount);
$("#J_topCartCount").addClass("top_bag").find("span").html("("+that.cartCount+")");!that.hasAsidebar&&$(".J_cart_count").html(that.cartCount).show()}else{that.cartListRemove();$("#J_headCartList_wrap").html(nsCart.defCartTip);$("#J_head_cart").addClass("head_bag_car");$("#J_shortTime").removeClass("time_out");$("#J_topCartCount").removeClass("top_bag").find("span").html("(0)")}return that},resetDefault:function(){var that=this,$J_headCartList_wrap=$("#J_headCartList_wrap");$("#J_skuCount").html("0");
$J_headCartList_wrap.html($("#J_headCartUnLogin_tmp").html());$.Listeners.pub("cart.reset.success").success({num:0,open:false});that.isTimeout=true},countDown:function(time){var that=nsCart,rt=VIPSHOP.core3===true?VIPSHOP.Time.fn_countDown(that.endTime):fn_CountDown(that.endTime),sign=rt.min<5?"<b>! </b>":"",title=$("#J_head_cart_title");if(!that.left5Mark&&rt.min<5){$("#J_shortTime").addClass("time_out");that.left5Mark=true}$(".J_cartCountdown").html(sign+rt.min+"\u5206"+rt.sec+"\u79d2");if(!that.left3Mark&&
rt.min=="02"){$.Listeners.pub("cart.timeshort").success({left:3});that.left3Mark=true}if(rt.sec=="0"&&rt.min=="0"){$.Listeners.pub("cart.timeout").success({left:-1});that.isTimeout=true;clearInterval(that.interval);$("#J_shortTime").removeClass("cart-have-goods");$("#J-mycartText").html("\u6211\u7684\u8d2d\u7269\u888b");$("#J-mycartText-countdown").addClass("hidden")}else if(that.hasAsidebar)that.barCountdown(rt);else{$(".J_cart_countDown").html(rt.min+"\u5206"+rt.sec+"\u79d2");$(".J_cart_countDowncart").html(rt.min+
":"+rt.sec+"");$("#J_shortTime").addClass("cart-have-goods");$("#J-mycartText").html("\u5546\u54c1\u5c06\u9884\u7559");$("#J-mycartText-countdown").removeClass("hidden")}return this},barCountdown:function(leftTime){var supportTransform=function(){var styles=document.createElement("div").style,vendors=["t","webkitT","MozT","msT","OT"],transform,i=0,item;while(item=vendors[i++]){transform=item+"ransform";if(transform in styles)return true}return false}();if(!supportTransform){$("#J_aside_cart").find("a").eq(0).after($("#J_barFontCountdown_tmp").html());
nsCart.barCountdown=function(leftTime){$("#J_barCountdown_min").html(leftTime.min);$("#J_barCountdown_sec").html(leftTime.sec)}}else{$("#J_aside_cart").find("a").eq(0).after($("#J_barRoundCountdown_tmp").html());nsCart.barCountdown=function(leftTime){var leftSec=+leftTime.min*60+ +leftTime.sec,deg=parseInt((1200-leftSec)*3/10);if(deg>180){$("#J_rightSector").css({"transform":"rotate(180deg)","-moz-transform":"rotate(180deg)","-webkit-transform":"rotate(180deg)"});$("#J_leftSector").css({"transform":"rotate("+
(deg-180)+"deg)","-moz-transform":"rotate("+(deg-180)+"deg)","-webkit-transform":"rotate("+(deg-180)+"deg)"})}else $("#J_rightSector").css({"transform":"rotate("+deg+"deg)","-moz-transform":"rotate("+deg+"deg)","-webkit-transform":"rotate("+deg+"deg)"})}}nsCart.barCountdown(leftTime)}};if(!isMobile){nsCart.addEvent=function(){var that=this;$("#J_head_cart").on({mouseenter:function(){var $J_headCartList_wrap=$("#J_headCartList_wrap"),isFreeReg=that.freeReg();$J_headCartList_wrap.show();$(this).addClass("head-cart-mouseon");
if(isFreeReg||$.Cookie.get("VipLID")){that.render();return}if(!$.Cookie.get("VipLID"))that.resetDefault()},mouseleave:function(){$("#J_headCartList_wrap").hide();$(this).removeClass("head-cart-mouseon")}})};nsCart.render=function(){nsCart.get(nsCart.renderCb,{isGetLast:1})};nsCart.renderCb=function(data){var that=nsCart;if(data.cartList&&data.cartList.count){if(!that.isTimeout&&(that.timeOpen==data.cartInfo.end_time&&that.productOpen==data.cartList.sku_count)){that.cartListUpdate();return}that.isTimeout=
false;that.cartCount=data.cartList.count;that.productOpen=that.skuCount=data.cartList.sku_count;that.timeOpen=that.endTime=data.cartInfo.end_time;var rt=VIPSHOP.core3===true?VIPSHOP.Time.fn_countDown(that.endTime):fn_CountDown(that.endTime);if(rt.sec=="0"&&rt.min=="0"){data.timeout=["1"];data.noTimeout=[]}else{data.timeout=[];data.noTimeout=["1"]}$("#J_headCartList_wrap").Template({templateElement:$("#J_cartList_template"),replace:true}).Template("process",data);that.hasScrollbar=false;that.cartListShow();
if(!that.hasAsidebar)$("#J_sidebar_carSection").Template({templateElement:$("#J_sidebar_car_template"),replace:true}).Template("process",data);if(data.cartList.count>4){$("#J_headCartList_wrap").find("ul").addClass("list_team_cn");if(!that.hasAsidebar)$("#J_sidebar_carSection").find("ul").addClass("cs_list_over")}$("#J_head_cart").removeClass("head_bag_car");$.Listeners.pub("cart.exists").success({num:data.cartList.count});$.Listeners.pub("cart.reset.success").success({num:data.cartList.sku_count,
open:true})}else $.Listeners.pub("cart.empty").success()}}else{nsCart.addEvent=function(){var self=this,isFreeReg=self.freeReg();$("#J_head_cart").on("click",function(e){e.preventDefault();!isFreeReg&&!$.Cookie.get("VipLID")?self.toLogin():self.showCartDialog()})};nsCart.showCartDialog=function(){var self=this,content="";self.get(function(data){if(data.cartList&&data.cartList.count){self.cartCount=data.cartList.count;self.skuCount=data.cartList.sku_count;self.endTime=data.cartInfo.end_time;content=
$.Template({templateElement:$("#J_cartList_template"),replace:null}).process(data);$.Listeners.pub("cart.exists").success({num:data.cartList.count})}else{content=self.defCartTip;$.Listeners.pub("cart.empty").success()}VIPSHOP.core3?$.Dialog({model:true,size:["272px"],custom:true,customStyle:true,content:content,clickMaskClose:true,showEvent:function(){self.cartListShow()},closeEvent:function(){clearInterval(self.interval);self.cartListRemove();this.destroy()}}).open():$.Dialog({model:true,size:["272px"],
opacity:0.6,content:content,showEvent:function(){var self=this;function closeHandle(){$("#_diaBackground").off("click.MobileDialog");self.close();clearInterval(self.interval);self.cartListRemove();this.destroy()}$("#_diaBackground").on("click.MobileDialog",function(){closeHandle()})}}).open()})};nsCart.render=function(){var self=this;self.get(nsCart.renderCb,{isGetLast:1})};nsCart.renderCb=function(data){var self=this;if(data&&(data.cartList&&data.cartList.count)){self.skuCount=data.cartList.sku_count;
self.setCartCount(self.cartCount=data.cartList.count)}}}module.exports=nsCart},{"./Cart.js":2,"./browserMod.js":7}],4:[function(require,module,exports){var PrePayMod={openOrderPrePayApi:window.openOrderPrePayApi,prePayListApi:"http://order.vip.com/presell/duetopaylist",init:function(){var _this=this;if(!!$.Cookie.get("VipLID")){var storage=$.Storage.get(_this.getStorageName()),storageData=storage.split("|@|")[1];if(typeof storageData!="undefined"&&storageData!="")$.Listeners.pub("vip_prePayList").success({code:200,
msg:"\u6267\u884c\u6210\u529f",result:$.parseJSON(storageData)});else this.getData()}$.Listeners.sub("vip_prePayList_check").onsuccess(function(data){_this.check(data.timeList)})},getStorageName:function(){var vipLID=$.Cookie.get("VipLID");return"vip_prePayList"+vipLID.replace(/\|/g,"_")},getData:function(){var _this=this;if(this.openOrderPrePayApi!="1")return false;$.ajax({url:this.prePayListApi,dataType:"jsonp",jsonp:"callback",jsonpCallback:"getPayList",timeout:6E3,success:function(re){if(re.code==
200){var now=(new Date).valueOf();if(re.result&&re.result.length>0)$.Storage.set(_this.getStorageName(),now+"|@|"+$.stringifyJSON(re.result),24*60*60);else $.Storage.set(_this.getStorageName(),now+"|@|"+$.stringifyJSON(re.result),10*60)}$.Listeners.pub("vip_prePayList").success(re)},error:function(){VIPSHOP.log("vip_prePayList_error")}})},check:function(timeList){if(!$.Cookie.get("VipLID"))return false;var _this=this,storage=$.Storage.get(_this.getStorageName()),storageTime=storage.split("|@|")[0]*
1,now=(new Date).valueOf();if(storageTime==0){_this.getData();return true}for(var i=0,len=timeList.length;i<len;i++){var curTime=timeList[i]*1;if(curTime<now){_this.getData();break}}}};module.exports=PrePayMod},{}],5:[function(require,module,exports){var nsUnpayOrder={init:function(){if(VIPSHOP.unpaid_orders&&(VIPSHOP.member&&(VIPSHOP.member.info&&VIPSHOP.member.info.account)))this.checkData(1)},checkData:function(type){var self=this;var data={userId:VIPSHOP.member.info.account};$.ajax({url:"http://checkout.vip.com/app/getUnpayOrder.php",
data:data,dataType:"jsonp",timeout:6E3,success:function(re){VIPSHOP.unpayOrderData=re;if(type==1)self.showTips(re);else self.showDialog(re)}})},showTips:function(re){if(re.total>0){var self=this;var RUID=$.Cookie.get("VipRUID");var storageUnpayOrderId=$.Storage.get("unpayOrderId-"+RUID).split(",");var unpayTipDate=$.Storage.get("unpayTipDate");var RUID=$.Cookie.get("VipRUID");var T=new Date;var M=T.getMonth();var D=T.getDate();var date=[M,D].join("");for(var i=0,len=re.list.length;i<len;i++)if($.inArray(re.list[i]+
"",storageUnpayOrderId)==-1){$.Storage.set("unpayOrderId-"+RUID,re.list.join(","));$.Storage.set("hasCloseTip-"+RUID,0);break}if($.Storage.get("hasCloseTip-"+RUID)!="1"||unpayTipDate[RUID]!=date){$.Listeners.pub("header.get.payTip").success({num:re.total});var mark=$.type(unpayTipDate)=="object"?unpayTipDate:{};mark[RUID]=date;$.Storage.set("unpayTipDate",mark);$.Storage.set("hasCloseTip-"+RUID,1)}}},showDialog:function(re){if(re.total!=0)location.href="http://my.vip.com/orders/orders.php?&from=m_public_top_unpaid_link";
else $("body").append($("#J_order_notice_win_tpl").html())}};module.exports=nsUnpayOrder},{}],6:[function(require,module,exports){var browserMod=require("./browserMod.js"),isMobile=VIPSHOP.core3?VIPSHOP.Detect.mobile:VIPSHOP.isMobile,isGlobal=/\.vipglobal\.hk$/.test(window.location.hostname),hostName=isGlobal?".vipglobal.hk":".vip.com";var nsWhChange={selectPopTimer:null,sucWin:null,teLinkUrl:"http://www.vip.com",hkmctwCookie:{104107:1,104108:1,104109:1},nsWhChangeFlag:1,init:function(options){nsWhChange.options=
options;var lastArea=$.Storage.get("changedProvince"),ck_wh=$.Cookie.get("vip_wh"),ck_province=$.Cookie.get("vip_province"),useclass=UINFO.parseCookie()["luc"];nsWhChange.addEvent();function showProvince(province){var nowProvinceObj=$(".J_select_item[data-id="+province+"]"),nowProvinceName;if(nowProvinceObj.length){nowProvinceName=nowProvinceObj.html();nowProvinceObj.addClass("selected")}else nowProvinceName=nsWhChange.getProvinceName(province);$.Storage.set("changedProvince",{id:province,wh:ck_wh,
show:0});$("#J_selected_province").html(nowProvinceName);nsWhChange.setAreaSelect(province);$("#J-areaBinner .ico-arw-bodder").width($("#J_areaSelect_btn").innerWidth()-2)}if(!!ck_province)showProvince(ck_province);else $.ajax({url:"http://www.vip.com/ajax/warehouse.php",data:{writecookie:1},dataType:"jsonp",jsonpCallback:"writeWhCookie",timeout:6E3,success:function(re){if(re.code===200)showProvince(re.data.vip_province)}});var cookie_warehouse=$.Cookie.get("vip_wh");if(typeof relevanceHeaderFlag!=
"undefined"&&relevanceHeaderFlag)setInterval(function(){var getWhCookie=$.Cookie.get("vip_wh"),lastArea=$.Storage.get("changedProvince"),ck_province=$.Cookie.get("vip_province");if(nsWhChange.hkmctwCookie[lastArea.id]&&!nsWhChange.hkmctwCookie[ck_province]||!nsWhChange.hkmctwCookie[lastArea.id]&&nsWhChange.hkmctwCookie[ck_province])if(nsWhChange.nsWhChangeFlag==1)location.href="http://www.vip.com";if(cookie_warehouse!=""&&(getWhCookie!=""&&getWhCookie!=cookie_warehouse)){var wareHouseData={};wareHouseData.lastWh=
cookie_warehouse;wareHouseData.selectWh=getWhCookie;$.Listeners.pub("whChange").success({data:wareHouseData});$.Listeners.unsub("whChange").success()}},1E3);$.Listeners.sub("whChange").onsuccess(function(data){if(nsWhChange.nsWhChangeFlag==1){var lastWh=data.data.lastWh;var selectWh=data.data.selectWh;nsWhChange.relevanceAjax(lastWh,selectWh,1)}});$.Listeners.sub("choosePro").onsuccess(function(){nsWhChange.setAreaSelect()})},addEvent:$.noop,areaItemClick:function($elem){var id=$elem.data("id"),wh=
$elem.data("wh"),ck_province=$.Cookie.get("vip_province");if(isGlobal){$.Cookie.set("__vip_wh_p",wh+"|"+id,hostName,"/",720);window.location.href="http://www.vip.com/welcometoglobal.php?url="+encodeURIComponent(nsWhChange.hkmctwCookie[id]||nsWhChange.hkmctwCookie[$.Cookie.get("vip_province")]?"http://www.vip.com":window.location.href);return}nsWhChange.nsWhChangeFlag=0;if(id!=ck_province){nsWhChange.changeArea(id,wh);var codeFlag=false;if(reloadAreaCode!=null)for(var codeNum in reloadAreaCode)if(reloadAreaCode[codeNum]==
id||reloadAreaCode[codeNum]==ck_province)codeFlag=true;if(codeFlag)window.location.reload()}},changeRelevance:function(flag){var selectWh=$.Cookie.get("vip_wh");if(typeof wareHouse!="undefined")nsWhChange.relevanceAjax(wareHouse,selectWh,flag)},changeArea:function(selectId,selectWh){var seleItem=$(".J_select_item[data-id="+selectId+"]"),seleName=seleItem.html(),lastId=$.Cookie.get("vip_province"),lastWh=$.Cookie.get("vip_wh");$.Storage.set("changedProvince",{id:lastId,wh:lastWh,show:0});$.Cookie.set("vip_wh",
selectWh,hostName,"/",720);$.Cookie.set("vip_province",selectId,hostName,"/",17520);$("#J_selected_province").html(seleName);if(lastWh!=""&&selectWh!=lastWh||(nsWhChange.hkmctwCookie[lastId]&&!nsWhChange.hkmctwCookie[selectId]||!nsWhChange.hkmctwCookie[lastId]&&nsWhChange.hkmctwCookie[selectId]))$.crossStorage.get("cartData",function(cartData){var changedProvince=$.Storage.get("changedProvince")||{};if(typeof cartData.cartList=="undefined"||cartData.cartList.count==0)changedProvince.cart=0;else changedProvince.cart=
1;$.crossStorage.set("cartData",{},0,function(){});$.Storage.set("changedProvince",changedProvince);if(nsWhChange.hkmctwCookie[lastId]&&!nsWhChange.hkmctwCookie[selectId]||!nsWhChange.hkmctwCookie[lastId]&&nsWhChange.hkmctwCookie[selectId])location.href="http://www.vip.com";else{nsWhChange.relevanceAjax(lastWh,selectWh,0);$(".J_select_item").removeClass("selected");seleItem.addClass("selected")}});else{nsWhChange.switchPop(0,0,selectWh);$(".J_select_item").removeClass("selected");seleItem.addClass("selected")}},
getUrlParam:function(name){var search=document.location.search;var pattern=new RegExp("[?&]"+name+"=([^&]+)","g");var matcher=pattern.exec(search);var items=null;if(null!=matcher)try{items=decodeURIComponent(decodeURIComponent(matcher[1]))}catch(e){try{items=decodeURIComponent(matcher[1])}catch(e){items=matcher[1]}}return items},relevanceAjax:function(lastWh,selectWh,otherFlag){var self=this;var brandId="",merSn="",sizeSn="";var user_class_c3="";var size_id=$("form").find("[name=size_id]").val();
if(typeof brand!="undefined")brandId=brand.id;else if(typeof O_viewed!="undefined")brandId=O_viewed.brandId;if(typeof I_merSn!="undefined")merSn=I_merSn;if(UINFO.parseCookie()["suc"]=="c3")user_class_c3="0|0|0|1";if(typeof sizeArray!="undefined"&&size_id!="")for(var i in sizeArray)if(sizeArray[i].id==size_id)sizeSn=sizeArray[i].sn;var lastArea=$.Storage.get("changedProvince");if(relevaceFlag&&(typeof In_warehouse!="undefined"&&!In_warehouse[selectWh]))$.ajax({url:"http://www.vip.com/ajax/relevance.php",
data:{brand_id:brandId,mer_sn:merSn,size_sn:sizeSn,wh:lastWh,to_wh:selectWh,f:user_class_c3,preview:self.getUrlParam("preview"),token:self.getUrlParam("token"),preview_cc_useMerRelevance:"true"},dataType:"jsonp",jsonpCallback:"relevanceAjax",timeout:6E3,success:function(data){var lastArea=$.Storage.get("changedProvince");$.Listeners.pub("relevaceData").success({data:data});nsWhChange.relevacePop(lastArea.cart,otherFlag)}});else{nsWhChange.switchPop(lastArea.cart,otherFlag,selectWh);if(lastArea.cart==
0&&(typeof I_pageType!="undefined"&&I_pageType==0))setTimeout(function(){window.location.href=nsWhChange.teLinkUrl},1500);else if(typeof I_pageType=="undefined"&&(lastArea.cart==0&&(!window.VIPCATEGORY&&!nsWhChange.options)))setTimeout(function(){location.href=location.href},1500)}},relevacePop:function(hadCart,otherFlag){if(!nsWhChange.relevaceWin){var winObj=$("#J_selectAreaNoCart_tmp"),size=[270,156];$.Listeners.sub("relevaceData").onsuccess(function(data){var releData=data.data;if(!otherFlag)if(hadCart||
releData.redirect==""&&I_pageType!=0){winObj=$("#J_selectAreaSuc_tmp");size=[390,235]}else winObj=$("#J_selectAreaNoCart_tmp");else if(releData.redirect==""&&I_pageType!=0){winObj=$("#J_warehouse_change");size=[390,235]}else winObj=$("#J_selectAreaNoCart_tmp")});var dialogConfig={content:winObj,model:true,showEvent:function(){var selectId=$.Cookie.get("vip_province"),seleName=$(".J_select_item[data-id="+selectId+"]").html(),lastChange=$.Storage.get("changedProvince");$(".J_selectProvince_name").html(seleName);
var $relevaceBtn=$("#J_relevaceBtn");var $relevaceMsg1=$(".J_relevaceMsg1");var $relevaceMsg2=$(".J_relevaceMsg2");var $relevaceMsg3=$(".J_relevaceMsg3");var lastArea=$(".J_select_item[data-id="+lastChange.id+"]");lastArea.length>0&&$(".J_lastProvinceName").html(lastArea.html());if(hadCart&&!otherFlag)$.Listeners.sub("relevaceData").onsuccess(function(data){var releData=data.data;if(releData.redirect!=""||(typeof I_pageType=="undefined"||I_pageType==0)){$relevaceBtn.text("\u6211\u77e5\u9053\u4e86");
$relevaceMsg1.removeClass("hidden")}else{$relevaceBtn.text("\u53bb\u7279\u5356\u4f1a\u9996\u9875");$relevaceMsg2.removeClass("hidden");if(typeof I_pageType!="undefined"&&I_pageType==2)$(".J_prodOrList").text("\u5546\u54c1")}});else $.Listeners.sub("relevaceData").onsuccess(function(data){var releData=data.data;if(releData.redirect==""&&I_pageType!=0){$relevaceBtn.text("\u53bb\u7279\u5356\u4f1a\u9996\u9875");$relevaceMsg3.removeClass("hidden");if(typeof I_pageType!="undefined"&&I_pageType==2)$(".J_prodOrList").text("\u5546\u54c1")}else if(I_pageType==
0)setTimeout(function(){nsWhChange.relevaceWin.close();location.href=VIPSHOP.frontHost},1500);else setTimeout(function(){nsWhChange.relevaceWin.close();window.location.href="http://"+releData.redirect},1500)});lastChange.show=1;lastChange.cart=0;$.Storage.set("changedProvince",lastChange)}};if(VIPSHOP.core3===true){dialogConfig.custom=true;dialogConfig.size=size}nsWhChange.relevaceWin=$.Dialog(dialogConfig);$(document).on("click","#J_lastProvince_btn",function(){nsWhChange.relevaceWin.close();var lastArea=
$.Storage.get("changedProvince");nsWhChange.changeArea(lastArea.id,lastArea.wh);nsWhChange.relevaceWin.destroy();nsWhChange.relevaceWin=null}).on("click",".J_selectArea_close",function(){$.Listeners.sub("relevaceData").onsuccess(function(data){var releData=data.data;if(releData.redirect!="")window.location.href="http://"+releData.redirect;else window.location.href=nsWhChange.teLinkUrl})})}nsWhChange.relevaceWin.open()},switchPop:function(hadCart,otherFlag,selectWh){if(!nsWhChange.sucWin){var winObj=
$("#J_selectAreaNoCart_tmp"),size=[270,156],winFlag=1;if(hadCart&&(!otherFlag&&(typeof In_warehouse!="undefined"&&!In_warehouse[selectWh]))){winObj=$("#J_selectAreaSuc_tmp");size=[390,235];winFlag=0}else if(!relevaceFlag&&(!window.VIPCATEGORY&&(typeof I_pageType!="undefined"&&(I_pageType!=0&&(typeof wareHouse!="undefined"&&(typeof In_warehouse!="undefined"&&(!In_warehouse[selectWh]&&wareHouse!=selectWh))))))){winObj=$("#J_warehouse_change");size=[390,235];winFlag=0}var dialogConfig={content:winObj,
model:true,showEvent:function(){var selectId=$.Cookie.get("vip_province"),seleName=$(".J_select_item[data-id="+selectId+"]").html(),lastChange=$.Storage.get("changedProvince");$(".J_selectProvince_name").html(seleName);$("#J_selected_province").html(seleName);if(hadCart&&(!otherFlag&&(typeof In_warehouse!="undefined"&&!In_warehouse[selectWh]))){if(typeof I_pageType=="undefined"||I_pageType==0){var $relevaceMsg1=$(".J_relevaceMsg1");$relevaceMsg1.removeClass("hidden")}else{var $relevaceMsg2=$(".J_relevaceMsg2");
$relevaceMsg2.removeClass("hidden");if(typeof I_pageType!="undefined"&&I_pageType==2)$(".J_prodOrList").text("\u5546\u54c1")}var lastArea=$(".J_select_item[data-id="+lastChange.id+"]");lastArea.length>0&&$(".J_lastProvinceName").html(lastArea.html())}else{if(typeof I_pageType!="undefined"&&I_pageType==2)$(".J_prodOrList").text("\u5546\u54c1");setTimeout(function(){if(winFlag)nsWhChange.sucWin.close();if(window.VIPCATEGORY)if(VIPCOMM&&(VIPCOMM.all_warehouse&&location.pathname.indexOf("/search")==0)){for(var i in VIPCOMM.all_warehouse)if(VIPCOMM.all_warehouse[i]==
selectWh)break;location.href=location.href.replace(/search-(\d)+/,"search-"+i)}else location.href=location.href;else if(nsWhChange.options&&nsWhChange.options.whChangeJump===false||relevaceFlag&&(otherFlag&&(typeof In_warehouse!="undefined"&&!In_warehouse[selectWh])))location.href=location.href},1500)}lastChange.show=1;lastChange.cart=0;$.Storage.set("changedProvince",lastChange);$(document).on("click","#J_lastProvince_btn",function(){nsWhChange.sucWin.close();var lastArea=$.Storage.get("changedProvince");
nsWhChange.changeArea(lastArea.id,lastArea.wh);nsWhChange.sucWin.destroy();nsWhChange.sucWin=null}).on("click",".J_selectArea_close",function(){nsWhChange.sucWin.close();if(window.VIPCATEGORY)if(VIPCOMM&&(VIPCOMM.all_warehouse&&location.pathname.indexOf("/search")==0)){for(var i in VIPCOMM.all_warehouse)if(VIPCOMM.all_warehouse[i]==selectWh)break;location.href=location.href.replace(/search-(\d)+/,"search-"+i)}else location.href=location.href;else if(nsWhChange.options&&nsWhChange.options.whChangeJump===
false)location.href=location.href;else window.location.href=nsWhChange.teLinkUrl})}};if(VIPSHOP.core3===true){dialogConfig.custom=true;dialogConfig.size=size}nsWhChange.sucWin=$.Dialog(dialogConfig)}nsWhChange.sucWin.open()},getProvinceName:function(provinceId){var provinceName,data=VIPCOMM.warehouseCfg.items,i,j,iItem,jItem;provinceId=provinceId||$.Cookie.get("vip_province");if(!provinceId)return;for(i=0;iItem=data[i++];){iItem=iItem.item||[];for(j=0;jItem=iItem[j];j++)if(provinceId==jItem.id)return jItem.name}},
setAreaSelect:function(province){var $provinceObj;province=province||$.Cookie.get("vip_province");if(!province)return;$provinceObj=$(".J_select_item[data-id="+province+"]");$("#J_selected_province").html(this.getProvinceName());$("#J_area_content .selected").removeClass("selected");$provinceObj.addClass("selected")}};if(!isMobile)nsWhChange.addEvent=function(){$("#J_area_content").Template({templateElement:$("#J_selectArea_list"),replace:true}).Template("process",VIPCOMM["warehouseCfg"]);$("#J_areaSelect_btn").on({mouseenter:function(){var _this=
$(this);nsWhChange.selectPopTimer=setTimeout(function(){_this.addClass("selected");$("#J_area_content").show()},300)},mouseleave:function(){clearTimeout(nsWhChange.selectPopTimer);$(this).removeClass("selected");$("#J_area_content").hide()}}).removeClass("hidden");$("#J_area_content").delegate(".J_select_item","click",function(){nsWhChange.areaItemClick($(this))})};else nsWhChange.addEvent=function(){$("#J_areaSelect_btn").on("click",function(e){var content=$.Template({templateElement:$("#J_selectArea_list"),
replace:null}).process(VIPCOMM["warehouseCfg"]);VIPSHOP.core3?$.Dialog({model:true,custom:true,customStyle:true,content:content,clickMaskClose:true,showEvent:function(){var self=this;$("#J-areaBinner").delegate(".J_select_item","click",function(){nsWhChange.areaItemClick($(this));self.close()});nsWhChange.setAreaSelect()},closeEvent:function(){this.destroy()}}).open():$.Dialog({model:true,size:[],opacity:0.6,content:content,showEvent:function(){var self=this;function closeHandle(){$("#_diaBackground").off("click.MobileDialog");
self.close();self.destroy()}$("#J-areaBinner").delegate(".J_select_item","click",function(){nsWhChange.areaItemClick($(this));closeHandle()});$("#_diaBackground").on("click.MobileDialog",function(){closeHandle()});nsWhChange.setAreaSelect()}}).open()}).removeClass("hidden")};window.nsWhChange=nsWhChange;module.exports=nsWhChange},{"./browserMod.js":7}],7:[function(require,module,exports){var browserMod=function(){var _window=window,_document=document,div=_document.createElement("div"),style=div.style,
animationNames=["animation","WebkitAnimation","OAnimation","msAnimation","MozAnimation"],animationName=function(){var i=0,len=animationNames.length,name,n;for(;i<len;i++){name=animationNames[i];if(style[name]!==n)return name}return false}(),aniEndName={animation:"animationend",WebkitAnimation:"webkitAnimationEnd",OAnimation:"oAnimationEnd",msAnimation:"MSAnimationEnd",MozAnimation:"mozAnimationEnd"}[animationName],support={touch:"ontouchstart"in div||_window.DocumentTouch&&_document instanceof _window.DocumentTouch,
orientation:"onorientationchange"in _window&&typeof _window.orientation!=="undefined",resize:"onresize"in _window,animation:!!aniEndName};_window=_document=div=style=animationName=animationNames=null;return{isMobile:support.touch&&support.orientation,spTouch:support.touch,spOrientation:support.orientation,spResize:support.resize,spAnimation:support.animation,aniEndName:aniEndName}}();module.exports=browserMod},{}],8:[function(require,module,exports){var nsHead={init:function(){var self=this,listenerId;
self.userName=$.Cookie.get("VipRNAME");listenerId=$.Listeners.sub("loginSuccess").onsuccess(function(){self.userName=$.Cookie.get("VipRNAME");$.Listeners.unsub("loginSuccess").success(listenerId);$("#J-topNavTool").removeClass("f-top-login-before").addClass("f-top-login-after");self.loginSuccessHtml().loginSuccessAddEvent().userLevel();if(typeof window.isIndexMark!=="undefined"&&isIndexMark===1)$.Listeners.sub("ready.four").onsuccess(function(){$.ajax({url:"index-ajax.php",data:{act:"getEPUserInfo",
user_id:$.Cookie.get("VipRUID")},dataType:"json",timeout:6E3,success:function(data){if(data&&data.logo)$("#J-vipLogo").attr("src",data.logo)}})})});if($("#J_phoneTip_con").length>0)self.phoneBindEvent();self.subEvent();self.bindEvent()},subEvent:function(){var self=this;$.Listeners.sub("unLogin").onsuccess(function(){var $JtopNavTool=$("#J-topNavTool");$JtopNavTool.removeClass("f-top-login-before");self.userName&&$JtopNavTool.addClass("f-top-login-usercookie");self.unLoginHtml()});$.Listeners.sub("header.get.payTip").onsuccess(function(re){$("#J-header-myOrder").html(re.num<
100?re.num:"99+").show()})},bindEvent:function(){$("#J-header-myOrder").closest("a").on("click",function(){$("#J-header-myOrder").html("")})},phoneBindEvent:function(){var $J_phone_tip=$("#J_phone_tip");$J_phone_tip.on({"mouseenter":function(){var $this=$(this);$this.addClass($this.attr("data-J-hover"));$("#J_phoneTip_con").show()},"mouseleave":function(){var $this=$(this);$this.removeClass($this.attr("data-J-hover"));$("#J_phoneTip_con").hide()}})},phoneAds:function(data,tplId){var self=this,$J_phoneTips_wrap=
$("#J_phoneTips_wrap"),$J_phone_tip=$("#J_phone_tip"),hasData=false;data=data.data;if(data&&(data.items&&data.items.length)){data=data.items[0];data.link=data.link||"javascript:void(0)";$J_phoneTips_wrap.Template({templateElement:$("#"+tplId),replace:false}).Template("process",data);hasData=true}if(hasData&&!$J_phone_tip.data("addEvent")){$J_phone_tip.data("addEvent",true);$J_phone_tip.on({"mouseenter":function(){var $this=$(this);$this.addClass($this.attr("data-J-hover"));$("#J_phoneTip_con").show()},
"mouseleave":function(){var $this=$(this);$this.removeClass($this.attr("data-J-hover"));$("#J_phoneTip_con").hide()}})}},page:function(){$(".J_te_card,.J_ILike,.J_header_cartCount").click(function(e){if(!$.Cookie.get("VipLID")&&!$.Cookie.get("Guest_ID")){window.open(VIPSHOP.userHost+"/login?gotype=1&src="+encodeURIComponent(window.location.href));return false}else return true});return this},userName:null,replaceUserName:function($obj,tpl){var userName=this.userName||"",re_account=/\{\$J_header_account\}/g,
newContent;tpl=tpl||$obj.html();newContent=tpl.replace(re_account,userName);$obj.html(newContent);return this},loginSuccessHtml:function(){this.replaceUserName($("#J_nPic_name"));$("#J_userInfo").addClass("user-login-ed");$("#J_head_log").removeClass("hidden");setTimeout(function(){$("#J-ico-arw-bodder").width($("#J-wp-user").innerWidth())},300);return this},loginSuccessAddEvent:function(){var self=this;$("#J_user_logined").on("mouseenter",function(){self.getMsg().getAvatar()});$(".J-logoutBtn").on("click",
function(){location.href=VIPSHOP.userHost+"/logout?src="+encodeURIComponent(window.location.href)});$("#J-favs").on("mouseenter",function(){if(self.favsDefLoading)return;self.favsDefLoading=true;$.when(self.fBcAjax(),self.fCcAjax()).always(function(){self.favsDefLoading=false}).done(function(re1,re2){self.favsDefDone(re1,re2)})});return this},timeout:null,unLoginHtml:function(){var self=this,register_tips,$J_user_noId;$("#J_header_lnkLogin").off("click");$("#J_header_lnkRegister").off("click");if(this.userName){this.replaceUserName($("#J_head_log"),
$("#J_header_logAfter").html());$("#J_user_logined").hide();$("#J_user_unLogin").removeClass("hidden");$("#J_head_log").addClass("user-has-cookies");$("#J_Register_hasnoname").removeClass("hidden")}else{$("#J_head_log").html($("#J_header_logAfter").html());$("#J_user_logined").hide();$("#J_uInfo_welcom").html("\u60a8\u597d\uff01");$("#J_user_noId").removeClass("hidden");$("#J_Register_hasnoname").removeClass("hidden");$("#J_head_log").addClass("user-no-cookies")}$("#J_user_msg").hide();$(".J_header_lnkLogin").on("click",
function(){location.href=VIPSHOP.userHost+"/login?src="+encodeURIComponent(window.location.href);return false});$(".J_header_lnkRegister").on("click",function(){location.href=VIPSHOP.userHost+"/register?src="+encodeURIComponent(window.location.href);return false});$("#J_head_log").removeClass("hidden");setTimeout(function(){$("#J-ico-arw-bodder").width($("#J-wp-user").innerWidth())},300);return this},favCommodityCount:function(){var wh=$.Cookie.get("vip_wh");if(!wh)return this;$.ajax({url:"http://myi.vip.com/fav_sku/count",
type:"get",dataType:"jsonp",timeout:6E3,cache:false,data:{warehouse:wh},success:function(data){if(data.code===200)$("#J_favCommodity_count").html(data.data)}});return this},favBrandCount:function(){$.ajax({url:"http://fav.myopen.vip.com/brand/index?type=3",dataType:"jsonp",timeout:6E3,success:function(re){if(!re.error){if(re.id_num){var num=re.id_num<100?re.id_num:"99+";$("#J_favBrand_count").html(num)}}else VIPSHOP.log(re.errorMessage);$.Listeners.pub("myfavbrand").success(re)}});return this},getAvatar:function(){var self=
this;if(self.avatarData)self.replaceAvatar(self.avatarData);else $.ajax({url:"http://user.myopen.vip.com/user/userinfo",data:{fileds:"avatar"},dataType:"jsonp",timeout:6E3,success:function(re){self.avatarData=re;self.replaceAvatar(re)}});return this},replaceAvatar:function(re){if(re.code==0&&!!re.data.avatar)$("#J_userAvatar").attr("src",re.data.avatar)},userLevel:function(){var cklevel=parseInt($.Cookie.get("VipMonopoly"));if(cklevel||cklevel===0)$("#J_viplevel").find("i").addClass("uv-"+(cklevel+
1));return this},getMsg:function(){var self=this;if(self.userMessage)self.replaceMsg(self.userMessage);else $.ajax({url:"http://user.myopen.vip.com/message/numunread",dataType:"jsonp",timeout:6E3,success:function(data){self.userMessage=data;self.replaceMsg(data)}});return this},replaceMsg:function(data){var $J_user_msgIcon=$("#J_user_msgIcon");if(!data.code&&(data.data&&data.data.count))$J_user_msgIcon.show();else $J_user_msgIcon.hide()},favsDefLoading:false,favsDefDone:function(re1,re2){re1=re1[0];
re2=re2[0];if(re1.code==200)$("#J_favBrand_count").html(re1.data<100?re1.data:"99+");else VIPSHOP.log(re1);if(re2.code===200)$("#J_favCommodity_count").html(re2.data<100?re2.data:"99+")},fCcAjax:function(){return $.ajax({url:"http://myi.vip.com/fav_sku/count",dataType:"jsonp",timeout:6E3,data:{warehouse:$.Cookie.get("vip_wh")}})},fBcAjax:function(){return $.ajax({url:"//fav.vip.com/api/fav/brand/sn/count",dataType:"jsonp",timeout:6E3,jsonpCallback:"getBrandCount",data:{business:"VIPSALES"}})}};module.exports=
nsHead},{}],9:[function(require,module,exports){var responsiveMod=require("./responsiveMod.js");var navMod={width:0,init:function(){var self=this;$(".J_main_nav_link").removeClass("main-nav-hiden");$("#J_indexFloatNav").removeClass("float_snav_ovh");if(VIPSHOP.useRPS){responsiveMod.init().add(true,function(status){self.responsive(status)});self.addEvent();self.responsive({width:$(window).width()})}},addEvent:function(){var self=this;$(window).on("load",function(){self.responsive({width:$(window).width()})})},
responsive:function(status){if(!this.width||this.width>status.width)this.narrowed();else this.widthed();this.width=status.width},widthed:function(){var $nav1=$(".J_main_nav_link"),$nav2=$("#J-floatNavLink"),navMoreSlr=".J-navMore",nMcntSlr=".J-navMoreCnt",$nMcnt1=$nav1.find(nMcntSlr),$nMcnt2=$nav2.find(nMcntSlr);if($nav1.length&&$nMcnt1.length)$nav1.append($nMcnt1.children()).find(navMoreSlr).remove();if($nav2.length&&$nMcnt2.length)$nav2.append($nMcnt2.children()).find(navMoreSlr).remove();($nav1.length&&
$nMcnt1.length||$nav2.length&&$nMcnt2.length)&&this.narrowed()},narrowed:function(){var $nav1=$(".J_main_nav_link"),$nav2=$("#J-floatNavLink"),factorSlr=".J-navMore,.J-navMore li",$navMoreTpl=$("#J-navMore-tpl");if($nav1.length){this.changeLayout($nav1,$nav1.find("li").not(factorSlr),$navMoreTpl);this.fix($nav1)}if($nav2.length){this.changeLayout($nav2,$nav2.find("li").not(factorSlr),$navMoreTpl);this.fix($nav2)}},fix:function($target){var $navMore,$nMcnt,navMoreSlr=".J-navMore",nMcntSlr=".J-navMoreCnt";
$navMore=$target.find(navMoreSlr);$nMcnt=$navMore.find(nMcntSlr);if($navMore.length&&$navMore.position().top>$target.find("li").first().position().top)$nMcnt.prepend($navMore.prev().remove())},changeLayout:function($target,$children,$tpl){var target=$target.get(0),wraps=this.getWraps($children),$navMore=$target.find(".J-navMore"),fragment=document.createDocumentFragment(),i=0,len=wraps.length;if(!len)return;!$navMore.length&&$target.append($tpl.html());for(;i<len;i++)fragment.appendChild(wraps[i]);
$target.find(".J-navMoreCnt").prepend(fragment);fragment=null},getWraps:function($children){var top,wraps=[],i=0,len=$children.length;if(!len)return wraps;top=$($children[i++]).position().top;for(;i<len;i++)if($($children[i]).position().top>top){wraps[wraps.length]=$children[i++];for(;i<len;i++)wraps[wraps.length]=$children[i];break}return wraps}};module.exports=navMod},{"./responsiveMod.js":10}],10:[function(require,module,exports){var browserMod=require("./browserMod.js"),oTcCbs={},resizeCbs={},
eventName=".responsiveMod_"+Math.random().toString(36).substr(2).substr(0,4),guid=1;function queueInit(){oTcCbs={name:"o",callbacks:{}};resizeCbs={name:"r",callbacks:{}}}function createCbAddFunc(){var self=responsiveMod,args=[].slice.call(arguments);return function(callback,run){var status,eventIds=[],i=0,len=args.length,item;if(!$.isFunction(callback))run=[callback,callback=run][0];if(!$.isFunction(callback))return false;for(;i<len;i++){item=args[i];item.callbacks[guid]=callback;eventIds[eventIds.length]=
item.name+":"+guid++}run&&callback(self.getStatus());return eventIds.join("|")}}var responsiveMod={timeout:0,inited:false,init:function(){if(this.inited)return this;this.addEvent();this.inited=true;return this},destroy:function(){queueInit();this.removeEvent();this.inited=false;return this},addEvent:function(options){var self=this,events=[browserMod.spResize?"resize"+eventName:"",browserMod.spOrientation?"orientationchange"+eventName:""];$(window).on(events.join(" "),function(e){self.timeout&&clearTimeout(self.timeout);
self.timeout=setTimeout(function(){self.handle(e.type);self.timeout=null},200)})},removeEvent:function(){$(window).off(eventName)},add:null,resize:null,oTchange:null,remove:function(eventIds){eventIds=(eventIds||"").split("|");if(!eventIds[0])return false;var hash={o:oTcCbs.callbacks,r:resizeCbs.callbacks},i=0,len=eventIds.length,item,callbacks,result=true;for(;i<len;i++){item=eventIds[i].split(":");callbacks=hash[item[0]];result=callbacks&&(callbacks[item[1]]&&(delete callbacks[item[1]]&&result))}return!!result},
getStatus:function(){var _window=window;return{orientation:_window.orientation||0,width:$(_window).width(),type:null}},handle:function(type){var callbacks,hash={orientationchange:oTcCbs.callbacks,resize:resizeCbs.callbacks},status=this.getStatus();status.type=type;callbacks=hash[type]||{};for(i in callbacks)callbacks[i](status);return this}};queueInit();responsiveMod.add=createCbAddFunc(oTcCbs,resizeCbs);responsiveMod.resize=createCbAddFunc(resizeCbs);responsiveMod.oTchange=createCbAddFunc(oTcCbs);
createCbAddFunc=null;module.exports=responsiveMod},{"./browserMod.js":7}]},{},[1]);
