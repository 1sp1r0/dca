window.Messenger=function(){function t(t,e,n){var i="";if(arguments.length<2?i="target error - target and name are both requied":"object"!=typeof t?i="target error - target itself must be window object":"string"!=typeof e&&(i="target error - target name must be string type"),i)throw new Error(i);this.target=t,this.name=e,this.prefix=n}function e(t,e){this.targets={},this.name=t,this.listenFunc=[],this.prefix=e||n,this.initListen()}var n="[PROJECT_NAME]",i="postMessage"in window;Object.prototype.toString;return i?t.prototype.send=function(t){this.target.postMessage(this.prefix+"|"+this.name+"__Messenger__"+t,"*")}:t.prototype.send=function(t){var e=window.navigator[this.prefix+this.name];if("function"!=typeof e)throw new Error("target callback function is not defined");e(this.prefix+"|"+this.name+"__Messenger__"+t,window)},e.prototype.addTarget=function(e,n){var i=new t(e,n,this.prefix);this.targets[n]=i},e.prototype.initListen=function(){var t=this,e=function(e){"object"==typeof e&&e.data&&(e=e.data);for(var n=e.split("__Messenger__"),e=n[1],i=n[0].split("|"),r=i[0],s=i[1],o=0;o<t.listenFunc.length;o++)r+s===t.prefix+t.name&&t.listenFunc[o](e)};i?"addEventListener"in document?window.addEventListener("message",e,!1):"attachEvent"in document&&window.attachEvent("onmessage",e):window.navigator[this.prefix+this.name]=e},e.prototype.listen=function(t){for(var e=0,n=this.listenFunc.length,i=!1;n>e;e++)if(this.listenFunc[e]==t){i=!0;break}i||this.listenFunc.push(t)},e.prototype.clear=function(){this.listenFunc=[]},e.prototype.send=function(t){var e,n=this.targets;for(e in n)n.hasOwnProperty(e)&&n[e].send(t)},e}();