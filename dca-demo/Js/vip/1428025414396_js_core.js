
var gdt_tracker=gdt_tracker||[];var __gdt_tracker_global_container=__gdt_tracker_global_container||{};(function(){var init=function(){var slice=Array.prototype.slice;var fnQueue;fnQueue={fnlist:{},exec:function(key){var fn,len,i,queue=fnQueue.fnlist[key]||[],args=slice.call(arguments,1);len=queue.length;for(i=0;i<len;i++){fn=queue[i];fn.apply(null,args);}},execOnce:function(key){var queue;fnQueue.exec(key);fnQueue.fnlist[key]=[];},add:function(key,cb){!fnQueue.fnlist[key]&&(fnQueue.fnlist[key]=[]);fnQueue.fnlist[key].push(cb);}};var extend=function(r){r=r||{};for(var i=1;i<arguments.length;i++){var s=arguments[i];if(s){for(var j in s){r[j]=s[j];}}}
return r;};var each=function(d,a,b){if(typeof d.length=="number"){for(var f=0,n=d.length;f<n;f++)a.call(b,d[f],f);}
else if(typeof d=="number"){for(f=0;f<d;f++)a.call(b,f,f);}
else{for(f in d)a.call(b,d[f],f);}};var map=function(d,a){var b=[];each(d,function(f,n){b.push(a(f,n));});return b;};var getObjectToStringFn=function(assign_token,pair_separator,need_last,need_encode){var encode=need_encode?encodeURIComponent:function(k){return k;};return function(o){return map(o,function(v,k){if(k!=null){return k+assign_token+encode(v);}}).join(pair_separator)+(need_last?pair_separator:'');};};var getType=function(obj){return obj===null?'null':(obj===undefined?'undefined':Object.prototype.toString.call(obj).slice(8,-1).toLowerCase());};var escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;var meta={'\b':'\\b','\t':'\\t','\n':'\\n','\f':'\\f','\r':'\\r','"':'\\"','\\':'\\\\'};function quote(string){escapable.lastIndex=0;return escapable.test(string)?'"'+string.replace(escapable,function(a){var c=meta[a];return typeof c==='string'?c:'\\u'+('0000'+a.charCodeAt(0).toString(16)).slice(-4);})+'"':'"'+string+'"';}
var JsonToString=function(obj){if(typeof JSON!='undefined'&&JSON.stringify){return JSON.stringify(obj);}else{var str='',arr=[],type;var otype=getType(obj);var bstart=(otype=='array')?'[':'{';var bend=(otype=='array')?']':'}';str+=bstart;each(obj,function(v,k){var substr="";if(otype!='array'){substr="\""+k+"\":";}
type=getType(v);if(type=='string'){substr+=quote(v);}else if(type=='number'){substr+=v;}else if(type=='undefined'){substr+=type;}else if(type=='object'||type=='array'){substr+=JsonToString(v);}
arr.push(substr);});str+=arr.join(',');str+=bend;return str;}};var Util={serializeQuery:getObjectToStringFn('=','&',false,true),__imgs:[],pingreq:function(url){setTimeout(function(){var img=new Image();img.src=url;Util.__imgs.push(img);},0);}};var CONST={maxUrlLength:2E3,MAXQUEUECOUNT:3,OPTFIELD:'optionfields'};GDT={config:{actionCgi:'http://tubi.gdt.qq.com/track.cgi',maxUrlLength:CONST.maxUrlLength,SIDPLACEMENT:'{sid}',MAXQUEUECOUNT:CONST.MAXQUEUECOUNT},CONST:CONST,run:function(config){GDT.dealActionConf(config);},__setSourceId:function(config){if(config[1]){GDT.config._currentSourceId=config[1];}},trimQueueData:function(dq){var actions=[];each(dq,function(queue,action){actions.push(action);});each(actions,function(action){var queue=dq[action];if(!queue){return;}
if(queue.action==="order"||queue.action==="orderinfo"){var queuebyvalue=queue.queuebyvalue,list,data,otherqueue,otherkey=((queue.action=="order")?"orderinfo":"order")+queuebyvalue;otherqueue=dq[otherkey];var dqueue=(queue.action==="orderinfo")?queue:otherqueue;data=dqueue&&dqueue.list&&dqueue.list[0]||{};extend(queue.data,data);if(queue.action==="orderinfo"){queue.list=otherqueue&&otherqueue.list||[];}
queue.action="order";delete dq[otherkey];}});},__reportNow:function(){var dq=GDT.queueActionData;GDT.trimQueueData(dq);each(dq,function(queue,action){GDT.multiActionReq(queue.action,queue);});GDT.queueActionData={};var sid=GDT.config._currentSourceId,placement=GDT.config.SIDPLACEMENT,req;if(!sid){return;}
while(req=GDT._reqQueue.shift()){if(req.data.sid===placement&&sid){req.data.sid=sid;}
GDT.sendReq(req);}},_reqQueue:[],enqueueReq:function(req){GDT._reqQueue.push(req);},pushCmd:function(config){GDT.dealActionCmd(config);},queueActionData:{},dealActionConf:function(pageconfig){each(pageconfig,function(config){GDT.dealActionCmd(config);});},dealActionCmd:function(config){var action=config[0],curActionMap=GDT.actionMap[action];if(!curActionMap){return;}
if(curActionMap.fn){GDT[curActionMap.fn](config);return;}},__addAction:function(config){config=config.slice(1);var action=config[0],curActionMap=GDT.actionMap[action],actionData={},listname,isMulti=false;if(!curActionMap){return;}
actionData.action=curActionMap.action;curActionMap.type=='multi'&&(isMulti=true)&&(listname=curActionMap.listname);each(curActionMap.list,function(field,key){var fieldconfig=field.split(":");var setValue=function(field,fieldconfig,key){key=key+1;if(fieldconfig.length==2&&fieldconfig[0]==='url'){actionData[fieldconfig[1]]=config[key]||location.href;}else if(field===CONST.OPTFIELD){var opts=config[key];if(getType(opts)==='object'){each(opts,function(ov,ok){actionData[ok]=ov;});}}else{actionData[field]=config[key]||"";}};setValue(field,fieldconfig,key);});if(!isMulti){GDT.sendActionReq(actionData);}else{var queuekey,dq=GDT.queueActionData;queuekey=actionData.action+((curActionMap.multiqueue)?actionData[curActionMap.queueby]:"");dq[queuekey]=dq[queuekey]||{};var cq=dq[queuekey];cq.list=cq.list||[];cq.data=cq.data||{};cq.queueby=curActionMap.queueby;cq.queuebyvalue=actionData[cq.queueby];cq.listname=listname;cq.action=curActionMap.action;delete actionData.action;cq.list.push(actionData);}},actionMap:{set_source_id:{fn:"__setSourceId",list:["accountId"]},send:{fn:'__reportNow'},add_action:{fn:'__addAction'},GENERAL:{action:"general",list:["type","url:pageurl"]},ITEM_VIEW:{action:"itemview",list:["itemid","url:itemurl","categoryid","categoryname","brandid","shopid",CONST.OPTFIELD]},ADD_TO_CART:{action:"addtocart",type:"multi",listname:"itemlist",list:["itemid","url:itemurl","categoryid","categoryname","brandid","shopid"]},ORDER:{action:"orderinfo",type:"multi",multiqueue:true,queueby:"orderid",listname:"itemlist",list:["orderid","cost"]},ORDER_ITEM:{action:"order",type:"multi",multiqueue:true,queueby:"orderid",listname:"itemlist",list:["orderid","itemid","url:itemurl","categoryid","categoryname","brandid","shopid"]},SHOP_VIEW:{action:"shopview",list:["shopid","url:shopurl","shopname"]},CATEGORY_VIEW:{action:"categoryview",list:["categoryid","categoryname","url:categoryurl"]},SEARCH:{action:"search",list:["query","categoryid","categoryname","url:queryurl"]},REGISTER:{action:"register",list:["name","sex","age","height","weight",CONST.OPTFIELD]},USERINFO:{action:"userview",list:["userid","name","sex","age","height","weight",CONST.OPTFIELD]},DOWNLOAD:{action:"download",list:["appname","appid","appsize","appurl"]},APPOINT:{action:"appointment",list:["appoint_time",CONST.OPTFIELD]}},multiActionReq:function(action,queue){var itemlist,data,clist;queue=queue||{};data=queue.data;data.action=action;data[queue.listname]=queue.list;data[queue.queueby]=queue.queuebyvalue;GDT.sendActionReq(data);},sendActionReq:function(actionData){var url=GDT.config.actionCgi,data,sid=GDT.config._currentSourceId||GDT.config.SIDPLACEMENT;actionData.timestamp=Math.ceil((+new Date())/1000);data=JsonToString(actionData);var qdata={sid:sid,data:data};GDT.enqueueReq({url:url,data:qdata});},sendReq:function(req){var query,url;query=Util.serializeQuery(req.data);url=req.url+"?"+query;Util.pingreq(url);},init:function(){var pageConfig=gdt_tracker;pageConfig.length&&this.run(pageConfig);gdt_tracker={push:GDT.pushCmd};}}
GDT.init();}
if(!__gdt_tracker_global_container.init){init();__gdt_tracker_global_container.init=true;}})();
$.Listeners && $.Listeners.pub('vtm_000017.loaded').success();